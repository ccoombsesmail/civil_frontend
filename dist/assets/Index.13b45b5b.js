import{d as x,U as B,R as t,u as y,r as b,k as R,l as F,M as w}from"./vendor.0dc98fef.js";import{b as O,a as Y}from"./formik.1e3cbfb7.js";import{T as v}from"./Index.906ab2cd.js";import{a as M,t as N,c as U,b as k,u as z,U as D}from"./useDetectCurrentPage.b5fea03e.js";import{R as L}from"./Index.c65c3301.js";import{u as A}from"./index.43cdcd02.js";import{g as H}from"./dateFormatter.922bcdf9.js";import"./index.3229f831.js";import"./Index.31c6c60e.js";import"./useOpenDidExplorer.5209bade.js";import"./Index.faa60f37.js";import"./axios.391ccac8.js";import"./@clerk/clerk-react.6c71122b.js";import"./@elastosfoundation/did-js-sdk.ab585390.js";import"./redux.3f1f2b08.js";import"./socket.io-client.b610e832.js";import"./redux-thunk.1b3bbe7b.js";import"./unicode-emoji-picker.85c61051.js";const q=n=>B(["40%{background:",";box-shadow:0 -18px 0 -8px ",",16px -8px 0 -8px ",",16px 8px 0 -8px ",",0 18px 0 -8px ",",-16px 8px 0 -8px ",",-16px -8px 0 -8px ",";}100%{background:",";box-shadow:0 -36px 0 -10px transparent,32px -16px 0 -10px transparent,32px 16px 0 -10px transparent,0 36px 0 -10px transparent,-32px 16px 0 -10px transparent,-32px -16px 0 -10px transparent;}"],n,n,n,n,n,n,n,n),G=x("div").withConfig({displayName:"Style__Container",componentId:"sc-1qnixmq-0"})(["position:relative;width:24px;height:24px;color:",";span{margin-left:.5vw;}input{position:absolute;top:0;left:0;width:24px;height:24px;border:2px solid #bfbfc0;border-radius:50%;z-index:9999999999;}label{z-index:999999999;width:24px;height:24px;background:none;border-radius:50%;position:absolute;top:0;left:0;-webkit-filter:url(#goo);filter:url(#goo);transform:translate3d(0,0,0);}svg{position:absolute;top:5px;left:4px;z-index:99999999999;pointer-events:none;path{stroke:white;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:19;stroke-dashoffset:19;transition:stroke-dashoffset .3s ease;transition-delay:.2s;}}input:checked{border:none;}input:checked + label{animation:"," .6s ease forwards;border:2px solid ",";+ svg path{stroke-dashoffset:0}}"],n=>n.color,n=>q(n.color),n=>n.color),X=x("input").withConfig({displayName:"Style__Input",componentId:"sc-1qnixmq-1"})(["-webkit-appearance:none;-moz-appearance:none;appearance:none;-webkit-tap-highlight-color:transparent;cursor:pointer;margin:0;&:focus{outline:0;}"]),j=({toxicityScore:n})=>{let r,e;return n<.6&&(r="green",e="Great!"),n>=.6&&n<=.9&&(r="var(--m-danger-color)",e="You are OK but getting close"),n>.9&&(r="red",e="You are being toxic"),t.createElement(t.Fragment,null,t.createElement(G,{color:r},t.createElement(X,{readOnly:!0,disabled:!0,checked:Boolean(n),type:"checkbox"}),t.createElement("label",null),t.createElement("svg",{width:"15",height:"14",viewBox:"0 0 15 14",fill:"none"},t.createElement("path",{d:"M2 8.36364L6.23077 12L13 2"}))),n&&t.createElement("span",{style:{marginLeft:"0.5vw"}},e),t.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",style:{width:0,height:0}},t.createElement("defs",null,t.createElement("filter",{id:"goo"},t.createElement("feGaussianBlur",{in:"SourceGraphic",stdDeviation:"4",result:"blur"}),t.createElement("feColorMatrix",{in:"blur",mode:"matrix",values:"1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 22 -7",result:"goo"}),t.createElement("feBlend",{in:"SourceGraphic",in2:"goo"})))))},V=(n,r)=>{const e=new Set,a=[n];for(;a.length!==0;){const i=a.shift();if(e.add(i.data.id),i.data.id===r)return i.data.content;i.children.forEach(s=>{e.has(s.data.id)||a.push(s)})}return""},W=(n,r,e)=>{var f,p,h;const a=y(o=>o.session.currentUser),i=(f=y(o=>o.topics.list))==null?void 0:f.find(o=>o.id===n),s=(p=y(o=>o.comments.list))==null?void 0:p.find(o=>{var u;return((u=o.data)==null?void 0:u.id)===(e==null?void 0:e.rootParentCommentId)||(e==null?void 0:e.commentId)}),c=(h=y(o=>o.tribunalComments.list))==null?void 0:h.find(o=>{var u;return((u=o.data)==null?void 0:u.id)===(e==null?void 0:e.rootParentCommentId)}),{createdBy:m,createdByIconSrc:d,createdAt:l}=(s==null?void 0:s.data)||(c==null?void 0:c.data)||{};return b.exports.useMemo(()=>{const o=(e==null?void 0:e.replyType)!=="REPLY_FROM_TOPIC"?V(s||c,e==null?void 0:e.commentId):i==null?void 0:i.description;return{subtopicId:r,createdByIconSrc:d||(i==null?void 0:i.createdByIconSrc),username:a==null?void 0:a.username,createdBy:m||(i==null?void 0:i.createdBy)||(c==null?void 0:c.createdBy),time:l||(i==null?void 0:i.createdAt),htmlContent:o,rootParentCommentId:(e==null?void 0:e.rootParentCommentId)||null,type:e==null?void 0:e.replyType}},[i,a,s,r,e])},$=(n,r)=>new Promise((e,a)=>{r===!0&&a(),setTimeout(e.bind(null,r),n)}),K=(n,r,e,a,i,s)=>{const{isOnTribunalPage:c}=M(),{tribunalCommentUnderReviewId:m,commentId:d}=a||{},l=c&&m===d,f=l?null:d||null,p=l?null:n.rootParentCommentId,{createComment:h,createTribunalComment:o}=A(U,N);return b.exports.useCallback((u,{setSubmitting:S,resetForm:_})=>{R.promise(Promise.all([$(1500),k({content:e})]),{pending:"Analyzing Comment...",success:{render({data:E}){const g=E[1].data.SEVERE_TOXICITY;return g<.6?"Thanks For Being Civil!":g>=.6&&g<=.9?"Thanks for being semi-civil. Maybe say things a bit nicer":`You are being toxic :( 
 Your comment will be flagged`},icon:"\u{1F7E2}"},error:"Promise rejected \u{1F92F}"}).then(E=>{const g=E[1].data.SEVERE_TOXICITY;let C;g<.6&&(C="NOT_TOXIC"),g>.9&&(C="TOXIC");const I={...u,content:r,memeFlag:!1,parentId:f,contentId:i,subtopicId:i,topicId:s,createdBy:n.username,rootId:p,rawText:e,toxicityStatus:C};return c?o(I):h(I)}),S(!1),_({})},[n,r,e,a.tribunalCommentUnderReviewId,a.commentId,i])},J=x(O).withConfig({displayName:"Style__FormContainer",componentId:"sc-1lyn49o-0"})(["margin-top:0;border-radius:.5em;position:relative;"]),Q=x("p").withConfig({displayName:"Style__Description",componentId:"sc-1lyn49o-1"})(["  width:90%;padding:.5em 0;margin-bottom:2em;font-size:.85em;display:flex;align-items:center;justify-content:flex-start;background-color:white;color:black;"]),Z=x("div").withConfig({displayName:"Style__InputWrapper",componentId:"sc-1lyn49o-2"})(["display:flex;flex-direction:column;position:relative;width:100%;section{display:flex;justify-content:space-between;align-items:flex-end;width:30vw;position:absolute;bottom:0;padding:.2em .5em;background:#e0e5ec;border-radius:.4em;box-shadow:-7px -7px 20px 0px #fff9,-4px -4px 5px 0px #fff9,7px 7px 20px 0px #0002,4px 4px 5px 0px #0001,inset 0px 0px 0px 0px #fff9,inset 0px 0px 0px 0px #0001,inset 0px 0px 0px 0px #fff9,inset 0px 0px 0px 0px #0001;}"]),P=x("div").withConfig({displayName:"Style__Container",componentId:"sc-1lyn49o-3"})(["position:relative;h1{width:100%;margin:0;text-align:center;padding-bottom:.5em;border-bottom:1px solid black;}"]),ee=x("div").withConfig({displayName:"Style__ToxicityControls",componentId:"sc-1lyn49o-4"})(["flex-grow:1;display:flex;align-items:center;> div{margin-left:1vw;}p{margin:0 1em;color:#979cb0;font-weight:600;font-size:16px;letter-spacing:.1vw;}"]),T=new RegExp(/\b[0-9a-f]{8}\b-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-\b[0-9a-f]{12}\b/g),ye=({modalProps:n})=>{const r=b.exports.useRef(null),[e,a]=b.exports.useState({rawHTML:"",content:"",rawText:""}),[i,s]=b.exports.useState(null),{pathname:c}=F(),m=c.match(T)[0],d=c.match(T)[1],l=W(m,d,n),f=K(l,e.rawHTML,e.rawText,n,d||m,m);return z(r,l.htmlContent),t.createElement(P,null,t.createElement(Y,{initialValues:{content:"",positive:"",negative:"",neutral:""},validate:()=>{const p={};return e.content.length===0&&(p.content="Write Something"),p},onSubmit:f},({isSubmitting:p})=>t.createElement(t.Fragment,null,t.createElement(w.Header,{closeButton:!0},t.createElement(w.Title,null,"Write Your Reply")),t.createElement(J,null,t.createElement(w.Body,null,t.createElement(D,{iconSrc:l.createdByIconSrc,username:l.createdBy,time:H(l.time)}),t.createElement(Q,null,t.createElement("span",{ref:r})),t.createElement(Z,null,t.createElement(L,{content:e.content,setContent:a,setToxicityScore:s}))),t.createElement(w.Footer,null,t.createElement(ee,null,t.createElement("div",null,t.createElement("div",{style:{display:"flex",alignItems:"center"}},t.createElement(v,{type:"button",onClick:()=>k({content:e.rawText}).then(h=>{s(h.data.SEVERE_TOXICITY.toFixed(2))})},"Check Toxicity Score"),t.createElement(j,{toxicityScore:i})),t.createElement("p",null,i&&`Your toxicity score is ${i}`))),t.createElement(v,{type:"submit",disabled:p},"Submit"))))))};export{ye as default};
