(self["webpackChunkcivil"] = self["webpackChunkcivil"] || []).push([["vendors-node_modules_fractalwagmi_solana-wallet-adapter_dist_esm_index_js"],{

/***/ "./node_modules/@fractalwagmi/solana-wallet-adapter/node_modules/base-x/src/index.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/solana-wallet-adapter/node_modules/base-x/src/index.js ***!
  \*******************************************************************************************/
/***/ ((module) => {

"use strict";

// base-x encoding / decoding
// Copyright (c) 2018 base-x contributors
// Copyright (c) 2014-2018 The Bitcoin Core developers (base58.cpp)
// Distributed under the MIT software license, see the accompanying
// file LICENSE or http://www.opensource.org/licenses/mit-license.php.
function base (ALPHABET) {
  if (ALPHABET.length >= 255) { throw new TypeError('Alphabet too long') }
  var BASE_MAP = new Uint8Array(256)
  for (var j = 0; j < BASE_MAP.length; j++) {
    BASE_MAP[j] = 255
  }
  for (var i = 0; i < ALPHABET.length; i++) {
    var x = ALPHABET.charAt(i)
    var xc = x.charCodeAt(0)
    if (BASE_MAP[xc] !== 255) { throw new TypeError(x + ' is ambiguous') }
    BASE_MAP[xc] = i
  }
  var BASE = ALPHABET.length
  var LEADER = ALPHABET.charAt(0)
  var FACTOR = Math.log(BASE) / Math.log(256) // log(BASE) / log(256), rounded up
  var iFACTOR = Math.log(256) / Math.log(BASE) // log(256) / log(BASE), rounded up
  function encode (source) {
    if (source instanceof Uint8Array) {
    } else if (ArrayBuffer.isView(source)) {
      source = new Uint8Array(source.buffer, source.byteOffset, source.byteLength)
    } else if (Array.isArray(source)) {
      source = Uint8Array.from(source)
    }
    if (!(source instanceof Uint8Array)) { throw new TypeError('Expected Uint8Array') }
    if (source.length === 0) { return '' }
        // Skip & count leading zeroes.
    var zeroes = 0
    var length = 0
    var pbegin = 0
    var pend = source.length
    while (pbegin !== pend && source[pbegin] === 0) {
      pbegin++
      zeroes++
    }
        // Allocate enough space in big-endian base58 representation.
    var size = ((pend - pbegin) * iFACTOR + 1) >>> 0
    var b58 = new Uint8Array(size)
        // Process the bytes.
    while (pbegin !== pend) {
      var carry = source[pbegin]
            // Apply "b58 = b58 * 256 + ch".
      var i = 0
      for (var it1 = size - 1; (carry !== 0 || i < length) && (it1 !== -1); it1--, i++) {
        carry += (256 * b58[it1]) >>> 0
        b58[it1] = (carry % BASE) >>> 0
        carry = (carry / BASE) >>> 0
      }
      if (carry !== 0) { throw new Error('Non-zero carry') }
      length = i
      pbegin++
    }
        // Skip leading zeroes in base58 result.
    var it2 = size - length
    while (it2 !== size && b58[it2] === 0) {
      it2++
    }
        // Translate the result into a string.
    var str = LEADER.repeat(zeroes)
    for (; it2 < size; ++it2) { str += ALPHABET.charAt(b58[it2]) }
    return str
  }
  function decodeUnsafe (source) {
    if (typeof source !== 'string') { throw new TypeError('Expected String') }
    if (source.length === 0) { return new Uint8Array() }
    var psz = 0
        // Skip and count leading '1's.
    var zeroes = 0
    var length = 0
    while (source[psz] === LEADER) {
      zeroes++
      psz++
    }
        // Allocate enough space in big-endian base256 representation.
    var size = (((source.length - psz) * FACTOR) + 1) >>> 0 // log(58) / log(256), rounded up.
    var b256 = new Uint8Array(size)
        // Process the characters.
    while (source[psz]) {
            // Decode character
      var carry = BASE_MAP[source.charCodeAt(psz)]
            // Invalid character
      if (carry === 255) { return }
      var i = 0
      for (var it3 = size - 1; (carry !== 0 || i < length) && (it3 !== -1); it3--, i++) {
        carry += (BASE * b256[it3]) >>> 0
        b256[it3] = (carry % 256) >>> 0
        carry = (carry / 256) >>> 0
      }
      if (carry !== 0) { throw new Error('Non-zero carry') }
      length = i
      psz++
    }
        // Skip leading zeroes in b256.
    var it4 = size - length
    while (it4 !== size && b256[it4] === 0) {
      it4++
    }
    var vch = new Uint8Array(zeroes + (size - it4))
    var j = zeroes
    while (it4 !== size) {
      vch[j++] = b256[it4++]
    }
    return vch
  }
  function decode (string) {
    var buffer = decodeUnsafe(string)
    if (buffer) { return buffer }
    throw new Error('Non-base' + BASE + ' character')
  }
  return {
    encode: encode,
    decodeUnsafe: decodeUnsafe,
    decode: decode
  }
}
module.exports = base


/***/ }),

/***/ "./node_modules/@fractalwagmi/solana-wallet-adapter/node_modules/bs58/index.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/solana-wallet-adapter/node_modules/bs58/index.js ***!
  \*************************************************************************************/
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

const basex = __webpack_require__(/*! base-x */ "./node_modules/@fractalwagmi/solana-wallet-adapter/node_modules/base-x/src/index.js")
const ALPHABET = '123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz'

module.exports = basex(ALPHABET)


/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/connection-manager.js":
/*!************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/connection-manager.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "ConnectionManager": () => (/* binding */ ConnectionManager)
/* harmony export */ });
/* harmony import */ var _core_connection_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./core/connection.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/connection.js");
/* harmony import */ var _core_constants_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/constants.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/constants.js");
/* harmony import */ var _core_types_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/types.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/types.js");
/* harmony import */ var _core_utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./core/utils.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/utils.js");




class ConnectionManager {
    constructor(platform) {
        this.platform = platform;
        this.connection = null;
        this.popupWindow = null;
        this.handleMessage = (e) => {
            var _a, _b;
            if (!(0,_core_utils_js__WEBPACK_IMPORTED_MODULE_3__.validateOrigin)(e.origin)) {
                return;
            }
            const validatedOrigin = e.origin;
            if (!this.popupWindow) {
                return;
            }
            if (e.data.event === _core_types_js__WEBPACK_IMPORTED_MODULE_2__.PopupEvent.HANDSHAKE && !this.connection) {
                if (!this.verifyAndResetNonce((_a = e.data.payload) === null || _a === void 0 ? void 0 : _a.nonce)) {
                    return;
                }
                this.popupWindow.postMessage({
                    event: _core_types_js__WEBPACK_IMPORTED_MODULE_2__.PopupEvent.HANDSHAKE_ACK,
                    payload: {
                        platform: this.platform,
                    },
                }, validatedOrigin);
                this.connection = new _core_connection_js__WEBPACK_IMPORTED_MODULE_0__.Connection(validatedOrigin, this.popupWindow);
                (_b = this.connectionUpdatedCallback) === null || _b === void 0 ? void 0 : _b.call(this, this.connection);
            }
            if (!this.connection) {
                return;
            }
            this.connection.runHandlersForEvent(e.data.event, e.data.payload);
            if (e.data.event === _core_types_js__WEBPACK_IMPORTED_MODULE_2__.PopupEvent.POPUP_CLOSED && this.connection) {
                this.resetConnection();
                this.popupWindow = null;
            }
        };
    }
    initialize() {
        window.addEventListener('message', this.handleMessage);
        return this;
    }
    tearDown() {
        window.removeEventListener('message', this.handleMessage);
        this.resetConnection();
        return this;
    }
    open({ url, widthPx = _core_constants_js__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_POPUP_WIDTH_PX, heightPx = _core_constants_js__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_POPUP_HEIGHT_PX, nonce, }) {
        var _a;
        if ((_a = this.popupWindow) === null || _a === void 0 ? void 0 : _a.closed) {
            this.resetConnectionAndPopupWindow();
        }
        if (this.popupWindow) {
            return;
        }
        this.initialize();
        if (nonce) {
            this.nonce = nonce;
        }
        const left = window.screenX + (window.innerWidth - widthPx) / 2;
        const top = window.screenY + (window.innerHeight - heightPx) / 2;
        this.popupWindow = (0,_core_utils_js__WEBPACK_IMPORTED_MODULE_3__.openPopup)({
            height: heightPx,
            left,
            top,
            url,
            width: widthPx,
        });
    }
    close() {
        if (!this.popupWindow) {
            return;
        }
        this.popupWindow.close();
        this.resetConnectionAndPopupWindow();
    }
    onConnectionUpdated(callback) {
        this.connectionUpdatedCallback = callback;
        return this;
    }
    getConnection() {
        return this.connection;
    }
    resetConnectionAndPopupWindow() {
        this.resetConnection();
        this.popupWindow = null;
    }
    resetConnection() {
        var _a, _b;
        (_a = this.connection) === null || _a === void 0 ? void 0 : _a.resetHandlers();
        this.connection = null;
        (_b = this.connectionUpdatedCallback) === null || _b === void 0 ? void 0 : _b.call(this, this.connection);
    }
    verifyAndResetNonce(uncheckedNonce) {
        if (!this.nonce) {
            return true;
        }
        const result = uncheckedNonce === this.nonce;
        if (result) {
            this.nonce = undefined;
        }
        return result;
    }
}
//# sourceMappingURL=connection-manager.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/connection.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/core/connection.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Connection": () => (/* binding */ Connection)
/* harmony export */ });
class Connection {
    constructor(validatedOrigin, targetWindow) {
        this.validatedOrigin = validatedOrigin;
        this.targetWindow = targetWindow;
        this.handlers = new Map();
    }
    off(event, callback) {
        const eventCallbacks = this.handlers.get(event);
        eventCallbacks === null || eventCallbacks === void 0 ? void 0 : eventCallbacks.delete(callback);
    }
    on(event, callback) {
        var _a;
        const eventCallbacks = (_a = this.handlers.get(event)) !== null && _a !== void 0 ? _a : new Set();
        eventCallbacks.add(callback);
        this.handlers.set(event, eventCallbacks);
    }
    send({ event, payload }) {
        this.targetWindow.postMessage({
            event,
            payload,
        }, this.validatedOrigin);
    }
    runHandlersForEvent(event, payload) {
        const eventCallbacks = this.handlers.get(event);
        if (!eventCallbacks) {
            return;
        }
        for (const callback of eventCallbacks) {
            callback(payload);
        }
    }
    resetHandlers() {
        this.handlers.clear();
    }
    export() {
        return {
            off: this.off.bind(this),
            on: this.on.bind(this),
            send: this.send.bind(this),
            validatedOrigin: this.validatedOrigin,
        };
    }
}
//# sourceMappingURL=connection.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/constants.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/core/constants.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "DEFAULT_POPUP_HEIGHT_PX": () => (/* binding */ DEFAULT_POPUP_HEIGHT_PX),
/* harmony export */   "DEFAULT_POPUP_WIDTH_PX": () => (/* binding */ DEFAULT_POPUP_WIDTH_PX),
/* harmony export */   "FRACTAL_DOMAIN": () => (/* binding */ FRACTAL_DOMAIN),
/* harmony export */   "FRACTAL_DOMAIN_HTTPS": () => (/* binding */ FRACTAL_DOMAIN_HTTPS),
/* harmony export */   "FRACTAL_DOMAIN_HTTPS_WWW": () => (/* binding */ FRACTAL_DOMAIN_HTTPS_WWW)
/* harmony export */ });
const FRACTAL_DOMAIN = 'fractal.is';
const FRACTAL_DOMAIN_HTTPS = 'https://fractal.is';
const FRACTAL_DOMAIN_HTTPS_WWW = 'https://www.fractal.is';
const DEFAULT_POPUP_WIDTH_PX = 400;
const DEFAULT_POPUP_HEIGHT_PX = 600;
//# sourceMappingURL=constants.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/types.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/core/types.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Platform": () => (/* binding */ Platform),
/* harmony export */   "PopupEvent": () => (/* binding */ PopupEvent)
/* harmony export */ });
var PopupEvent;
(function (PopupEvent) {
    PopupEvent["PROJECT_APPROVED"] = "PROJECT_APPROVED";
    PopupEvent["HANDSHAKE"] = "HANDSHAKE";
    PopupEvent["HANDSHAKE_ACK"] = "HANDSHAKE_ACK";
    PopupEvent["SIGNED_TRANSACTION"] = "SIGNED_TRANSACTION";
    PopupEvent["FAILED_TO_SIGN_TRANSACTION"] = "FAILED_TO_SIGN_TRANSACTION";
    PopupEvent["TRANSACTION_DENIED"] = "TRANSACTION_DENIED";
    PopupEvent["SOLANA_WALLET_ADAPTER_APPROVED"] = "SOLANA_WALLET_ADAPTER_APPROVED";
    PopupEvent["SOLANA_WALLET_ADAPTER_DENIED"] = "SOLANA_WALLET_ADAPTER_DENIED";
    PopupEvent["POPUP_CLOSED"] = "POPUP_CLOSED";
    PopupEvent["TRANSACTION_SIGNATURE_NEEDED"] = "TRANSACTION_SIGNATURE_NEEDED";
    PopupEvent["TRANSACTION_SIGNATURE_NEEDED_RESPONSE"] = "TRANSACTION_SIGNATURE_NEEDED_RESPONSE";
    PopupEvent["AUTH_LOADED"] = "AUTH_LOADED";
})(PopupEvent || (PopupEvent = {}));
var Platform;
(function (Platform) {
    Platform["UNKNOWN"] = "UNKNOWN";
    Platform["REACT_SDK"] = "REACT_SDK";
    Platform["SOLANA_WALLET_ADAPTER"] = "SOLANA_WALLET_ADAPTER";
})(Platform || (Platform = {}));
//# sourceMappingURL=types.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/utils.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/core/utils.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "openPopup": () => (/* binding */ openPopup),
/* harmony export */   "validateOrigin": () => (/* binding */ validateOrigin)
/* harmony export */ });
/* harmony import */ var _constants_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./constants.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/constants.js");

function validateOrigin(origin) {
    return origin === _constants_js__WEBPACK_IMPORTED_MODULE_0__.FRACTAL_DOMAIN_HTTPS_WWW || origin === _constants_js__WEBPACK_IMPORTED_MODULE_0__.FRACTAL_DOMAIN_HTTPS;
}
const TARGET = 'fractal:approval:popup';
const STATIC_POPUP_FEATURES = ['resizable', 'scrollbars=1', 'status=1'];
function openPopup({ left = 0, scope = window, top = 0, width = _constants_js__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_POPUP_HEIGHT_PX, height = _constants_js__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_POPUP_HEIGHT_PX, url, }) {
    return scope.open(url, TARGET, getPopupFeatures({ height, left, top, width }));
}
function getPopupFeatures({ height, left, top, width, }) {
    return [
        'popup',
        `left=${left}`,
        `top=${top}`,
        `width=${width}`,
        `height=${height}`,
        ...STATIC_POPUP_FEATURES,
    ].join(',');
}
//# sourceMappingURL=utils.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/index.js":
/*!***********************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/index.js ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "Connection": () => (/* reexport safe */ _core_connection_js__WEBPACK_IMPORTED_MODULE_1__.Connection),
/* harmony export */   "ConnectionManager": () => (/* reexport safe */ _connection_manager_js__WEBPACK_IMPORTED_MODULE_3__.ConnectionManager),
/* harmony export */   "DEFAULT_POPUP_HEIGHT_PX": () => (/* reexport safe */ _core_constants_js__WEBPACK_IMPORTED_MODULE_5__.DEFAULT_POPUP_HEIGHT_PX),
/* harmony export */   "DEFAULT_POPUP_WIDTH_PX": () => (/* reexport safe */ _core_constants_js__WEBPACK_IMPORTED_MODULE_5__.DEFAULT_POPUP_WIDTH_PX),
/* harmony export */   "Platform": () => (/* reexport safe */ _core_types_js__WEBPACK_IMPORTED_MODULE_0__.Platform),
/* harmony export */   "PopupEvent": () => (/* reexport safe */ _core_types_js__WEBPACK_IMPORTED_MODULE_0__.PopupEvent),
/* harmony export */   "assertPayloadIsSolanaWalletAdapterApproved": () => (/* reexport safe */ _payloads_index_js__WEBPACK_IMPORTED_MODULE_4__.assertPayloadIsSolanaWalletAdapterApproved),
/* harmony export */   "assertPayloadIsTransactionSignatureNeededPayload": () => (/* reexport safe */ _payloads_index_js__WEBPACK_IMPORTED_MODULE_4__.assertPayloadIsTransactionSignatureNeededPayload),
/* harmony export */   "assertPayloadIsTransactionSignatureNeededResponsePayload": () => (/* reexport safe */ _payloads_index_js__WEBPACK_IMPORTED_MODULE_4__.assertPayloadIsTransactionSignatureNeededResponsePayload),
/* harmony export */   "usePopupConnection": () => (/* reexport safe */ _use_popup_connection_js__WEBPACK_IMPORTED_MODULE_2__.usePopupConnection)
/* harmony export */ });
/* harmony import */ var _core_types_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./core/types.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/types.js");
/* harmony import */ var _core_connection_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/connection.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/connection.js");
/* harmony import */ var _use_popup_connection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./use-popup-connection.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/use-popup-connection.js");
/* harmony import */ var _connection_manager_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./connection-manager.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/connection-manager.js");
/* harmony import */ var _payloads_index_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./payloads/index.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/index.js");
/* harmony import */ var _core_constants_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./core/constants.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/constants.js");






//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/lib/guards.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/lib/guards.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "isObject": () => (/* binding */ isObject)
/* harmony export */ });
function isObject(value) {
    if (value === null) {
        return false;
    }
    if (typeof value !== 'object') {
        return false;
    }
    return true;
}
//# sourceMappingURL=guards.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/index.js":
/*!********************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/index.js ***!
  \********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "assertPayloadIsSolanaWalletAdapterApproved": () => (/* reexport safe */ _solana_wallet_adapter_approved_js__WEBPACK_IMPORTED_MODULE_0__.assertPayloadIsSolanaWalletAdapterApproved),
/* harmony export */   "assertPayloadIsTransactionSignatureNeededPayload": () => (/* reexport safe */ _transaction_signature_needed_js__WEBPACK_IMPORTED_MODULE_1__.assertPayloadIsTransactionSignatureNeededPayload),
/* harmony export */   "assertPayloadIsTransactionSignatureNeededResponsePayload": () => (/* reexport safe */ _transaction_signature_needed_response_js__WEBPACK_IMPORTED_MODULE_2__.assertPayloadIsTransactionSignatureNeededResponsePayload)
/* harmony export */ });
/* harmony import */ var _solana_wallet_adapter_approved_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./solana-wallet-adapter-approved.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/solana-wallet-adapter-approved.js");
/* harmony import */ var _transaction_signature_needed_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./transaction-signature-needed.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/transaction-signature-needed.js");
/* harmony import */ var _transaction_signature_needed_response_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./transaction-signature-needed-response.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/transaction-signature-needed-response.js");



//# sourceMappingURL=index.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/solana-wallet-adapter-approved.js":
/*!*********************************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/solana-wallet-adapter-approved.js ***!
  \*********************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "assertPayloadIsSolanaWalletAdapterApproved": () => (/* binding */ assertPayloadIsSolanaWalletAdapterApproved)
/* harmony export */ });
/* harmony import */ var _lib_guards_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/guards.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/lib/guards.js");

function assertPayloadIsSolanaWalletAdapterApproved(payload) {
    if (!(0,_lib_guards_js__WEBPACK_IMPORTED_MODULE_0__.isObject)(payload)) {
        return false;
    }
    if (!('solanaPublicKey' in payload)) {
        return false;
    }
    if (typeof payload.solanaPublicKey !== 'string') {
        return false;
    }
    return true;
}
//# sourceMappingURL=solana-wallet-adapter-approved.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/transaction-signature-needed-response.js":
/*!****************************************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/transaction-signature-needed-response.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "assertPayloadIsTransactionSignatureNeededResponsePayload": () => (/* binding */ assertPayloadIsTransactionSignatureNeededResponsePayload)
/* harmony export */ });
/* harmony import */ var _lib_guards_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/guards.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/lib/guards.js");

function assertPayloadIsTransactionSignatureNeededResponsePayload(payload) {
    if (!(0,_lib_guards_js__WEBPACK_IMPORTED_MODULE_0__.isObject)(payload)) {
        return false;
    }
    if (!('signedB58Transactions' in payload)) {
        return false;
    }
    if (!Array.isArray(payload.signedB58Transactions)) {
        return false;
    }
    return payload.signedB58Transactions.every(value => typeof value === 'string');
}
//# sourceMappingURL=transaction-signature-needed-response.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/transaction-signature-needed.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/payloads/transaction-signature-needed.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "assertPayloadIsTransactionSignatureNeededPayload": () => (/* binding */ assertPayloadIsTransactionSignatureNeededPayload)
/* harmony export */ });
/* harmony import */ var _lib_guards_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/guards.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/lib/guards.js");

function assertPayloadIsTransactionSignatureNeededPayload(payload) {
    if (!(0,_lib_guards_js__WEBPACK_IMPORTED_MODULE_0__.isObject)(payload)) {
        return false;
    }
    if (!('unsignedB58Transactions' in payload)) {
        return false;
    }
    if (!Array.isArray(payload.unsignedB58Transactions)) {
        return false;
    }
    return payload.unsignedB58Transactions.every(value => typeof value === 'string');
}
//# sourceMappingURL=transaction-signature-needed.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/popup-connection/dist/esm/use-popup-connection.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/popup-connection/dist/esm/use-popup-connection.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "usePopupConnection": () => (/* binding */ usePopupConnection)
/* harmony export */ });
/* harmony import */ var _connection_manager_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./connection-manager.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/connection-manager.js");
/* harmony import */ var _core_constants_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./core/constants.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/constants.js");
/* harmony import */ var _core_types_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./core/types.js */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/core/types.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! react */ "./node_modules/react/index.js");




const usePopupConnection = ({ enabled = true, platform = _core_types_js__WEBPACK_IMPORTED_MODULE_2__.Platform.UNKNOWN, widthPx = _core_constants_js__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_POPUP_WIDTH_PX, heightPx = _core_constants_js__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_POPUP_HEIGHT_PX, } = {}) => {
    const [exportedConnection, setExportedConnection] = (0,react__WEBPACK_IMPORTED_MODULE_3__.useState)(undefined);
    const connectionManagerRef = (0,react__WEBPACK_IMPORTED_MODULE_3__.useRef)(new _connection_manager_js__WEBPACK_IMPORTED_MODULE_0__.ConnectionManager(platform).onConnectionUpdated((connection) => {
        setExportedConnection(connection === null || connection === void 0 ? void 0 : connection.export());
    }));
    const open = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)((url) => {
        connectionManagerRef.current.open({
            heightPx,
            url,
            widthPx,
        });
    }, [connectionManagerRef, widthPx, heightPx]);
    const close = (0,react__WEBPACK_IMPORTED_MODULE_3__.useCallback)(() => {
        connectionManagerRef.current.close();
    }, [connectionManagerRef]);
    (0,react__WEBPACK_IMPORTED_MODULE_3__.useEffect)(() => {
        if (enabled) {
            connectionManagerRef.current.initialize();
        }
        else {
            connectionManagerRef.current.tearDown();
        }
    }, [connectionManagerRef]);
    return {
        close,
        connection: exportedConnection,
        open,
    };
};
//# sourceMappingURL=use-popup-connection.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/core/fractal-wallet-adapter-impl.js":
/*!*******************************************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/core/fractal-wallet-adapter-impl.js ***!
  \*******************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FractalWalletAdapterImpl": () => (/* binding */ FractalWalletAdapterImpl)
/* harmony export */ });
/* harmony import */ var _fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @fractalwagmi/popup-connection */ "./node_modules/@fractalwagmi/popup-connection/dist/esm/index.js");
/* harmony import */ var _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @solana/wallet-adapter-base */ "./node_modules/@solana/wallet-adapter-base/lib/esm/errors.js");
/* harmony import */ var _solana_web3_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @solana/web3.js */ "./node_modules/@solana/web3.js/lib/index.browser.esm.js");
/* harmony import */ var bs58__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! bs58 */ "./node_modules/@fractalwagmi/solana-wallet-adapter/node_modules/bs58/index.js");
/* harmony import */ var _nonce_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./nonce.js */ "./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/core/nonce.js");





const UNKNOWN_ERROR_MESSAGE = 'Unknown Error';
const FRACTAL_DOMAIN_HTTPS = 'https://fractal.is';
const APPROVE_PAGE_URL = `${FRACTAL_DOMAIN_HTTPS}/wallet-adapter/approve`;
const SIGN_PAGE_URL = `${FRACTAL_DOMAIN_HTTPS}/wallet-adapter/sign`;
const MIN_POPUP_HEIGHT_PX = _fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.DEFAULT_POPUP_HEIGHT_PX;
const MAX_POPUP_WIDTH_PX = 850;
const LOCAL_STORAGE_KEY_FOR_PUBLIC_KEY = 'RdxqNYxF';
class FractalWalletAdapterImpl {
    constructor() {
        this.popupManager = new _fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.ConnectionManager(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.Platform.SOLANA_WALLET_ADAPTER);
        this.publicKey = null;
        this.connecting = false;
    }
    getPublicKey() {
        return this.publicKey;
    }
    async connect() {
        let resolve;
        let reject;
        const publicKeyInLocalStorage = window.localStorage.getItem(LOCAL_STORAGE_KEY_FOR_PUBLIC_KEY);
        if (publicKeyInLocalStorage) {
            this.publicKey = new _solana_web3_js__WEBPACK_IMPORTED_MODULE_1__.PublicKey(publicKeyInLocalStorage);
            return Promise.resolve();
        }
        const nonce = (0,_nonce_js__WEBPACK_IMPORTED_MODULE_3__.createNonce)();
        this.popupManager.open({
            nonce,
            url: `${APPROVE_PAGE_URL}/${nonce}`,
        });
        const handleSolanaWalletAdapterApproved = (payload) => {
            if (!(0,_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.assertPayloadIsSolanaWalletAdapterApproved)(payload)) {
                reject(new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletConnectionError('Malformed payload when setting up connection. ' +
                    'Expected { solanaPublicKey: string } but ' +
                    `received ${JSON.stringify(payload)}`));
                this.popupManager.close();
                return;
            }
            try {
                this.publicKey = new _solana_web3_js__WEBPACK_IMPORTED_MODULE_1__.PublicKey(payload.solanaPublicKey);
                window.localStorage.setItem(LOCAL_STORAGE_KEY_FOR_PUBLIC_KEY, payload.solanaPublicKey);
                resolve();
            }
            catch (error) {
                const publicKeyError = new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletPublicKeyError(error instanceof Error ? error.message : UNKNOWN_ERROR_MESSAGE, error);
                reject(publicKeyError);
            }
            this.popupManager.close();
        };
        const handleExplicitDenialByUser = () => {
            reject(new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletConnectionError('The user denied the connection.'));
            this.popupManager.close();
        };
        const handleClosedByUser = () => {
            reject(new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletConnectionError('The user denied the connection.'));
            this.popupManager.close();
        };
        this.popupManager.onConnectionUpdated(connection => {
            if (!connection) {
                return;
            }
            connection.on(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.SOLANA_WALLET_ADAPTER_APPROVED, handleSolanaWalletAdapterApproved);
            connection.on(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.SOLANA_WALLET_ADAPTER_DENIED, handleExplicitDenialByUser);
            connection.on(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.POPUP_CLOSED, handleClosedByUser);
        });
        return new Promise((promiseResolver, promiseRejector) => {
            resolve = promiseResolver;
            reject = promiseRejector;
        });
    }
    async disconnect() {
        this.popupManager.tearDown();
        this.publicKey = null;
        window.localStorage.removeItem(LOCAL_STORAGE_KEY_FOR_PUBLIC_KEY);
    }
    async signTransaction(transaction) {
        try {
            this.checkWalletReadiness();
            const result = await this.signTransactions([transaction]);
            return result[0];
        }
        catch (error) {
            let errorToThrow = error;
            if (!(error instanceof _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletError)) {
                errorToThrow = new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletSignTransactionError(error instanceof Error ? error.message : UNKNOWN_ERROR_MESSAGE, error);
            }
            throw errorToThrow;
        }
    }
    async signAllTransactions(transactions) {
        try {
            this.checkWalletReadiness();
            const result = await this.signTransactions(transactions);
            return result;
        }
        catch (error) {
            let errorToThrow = error;
            if (!(error instanceof _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletError)) {
                errorToThrow = new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletSignTransactionError(error instanceof Error ? error.message : UNKNOWN_ERROR_MESSAGE, error);
            }
            throw errorToThrow;
        }
    }
    async signTransactions(transactions) {
        let resolve;
        let reject;
        const handleTransactionSignatureNeededResponse = (payload) => {
            if (!(0,_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.assertPayloadIsTransactionSignatureNeededResponsePayload)(payload)) {
                const error = new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletSignTransactionError('Malformed payload when signing transactions. ' +
                    'Expected { signedB58Transactions: string[] } ' +
                    `but received ${JSON.stringify(payload)}`);
                reject(error);
                this.popupManager.close();
                return;
            }
            const signedTransactions = payload.signedB58Transactions.map(signedB58Transaction => {
                return _solana_web3_js__WEBPACK_IMPORTED_MODULE_1__.Transaction.from(bs58__WEBPACK_IMPORTED_MODULE_2__.decode(signedB58Transaction));
            });
            resolve(signedTransactions);
            this.popupManager.close();
        };
        const handleClosedOrDeniedByUser = () => {
            reject(new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletSignTransactionError('The user did not approve the transaction'));
            this.popupManager.close();
        };
        const handleAuthLoaded = () => {
            var _a;
            const payload = {
                unsignedB58Transactions: transactions.map(t => bs58__WEBPACK_IMPORTED_MODULE_2__.encode(t.serializeMessage())),
            };
            (_a = this.popupManager.getConnection()) === null || _a === void 0 ? void 0 : _a.send({
                event: _fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.TRANSACTION_SIGNATURE_NEEDED,
                payload,
            });
        };
        const nonce = (0,_nonce_js__WEBPACK_IMPORTED_MODULE_3__.createNonce)();
        this.popupManager.open({
            heightPx: Math.max(MIN_POPUP_HEIGHT_PX, Math.floor(window.innerHeight * 0.8)),
            nonce,
            url: `${SIGN_PAGE_URL}/${nonce}`,
            widthPx: Math.min(MAX_POPUP_WIDTH_PX, Math.floor(window.innerWidth * 0.8)),
        });
        this.popupManager.onConnectionUpdated(connection => {
            if (!connection) {
                return;
            }
            connection.on(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.TRANSACTION_SIGNATURE_NEEDED_RESPONSE, handleTransactionSignatureNeededResponse);
            connection.on(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.TRANSACTION_DENIED, handleClosedOrDeniedByUser);
            connection.on(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.POPUP_CLOSED, handleClosedOrDeniedByUser);
            connection.on(_fractalwagmi_popup_connection__WEBPACK_IMPORTED_MODULE_0__.PopupEvent.AUTH_LOADED, handleAuthLoaded);
        });
        return new Promise((promiseResolver, promiseRejector) => {
            resolve = promiseResolver;
            reject = promiseRejector;
        });
    }
    checkWalletReadiness() {
        if (this.publicKey === null) {
            throw new _solana_wallet_adapter_base__WEBPACK_IMPORTED_MODULE_4__.WalletNotConnectedError('`publicKey` is null. Did you forget to call `.connect()`?');
        }
    }
}
//# sourceMappingURL=fractal-wallet-adapter-impl.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/core/nonce.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/core/nonce.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "createNonce": () => (/* binding */ createNonce)
/* harmony export */ });
function createNonce() {
    return `${randomString()}${randomString()}${randomString()}`;
}
function randomString() {
    return (Math.random() + 1).toString(36).substring(7);
}
//# sourceMappingURL=nonce.js.map

/***/ }),

/***/ "./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/index.js":
/*!****************************************************************************!*\
  !*** ./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/index.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "FractalWalletAdapterImpl": () => (/* reexport safe */ _core_fractal_wallet_adapter_impl_js__WEBPACK_IMPORTED_MODULE_0__.FractalWalletAdapterImpl)
/* harmony export */ });
/* harmony import */ var _core_fractal_wallet_adapter_impl_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./core/fractal-wallet-adapter-impl.js */ "./node_modules/@fractalwagmi/solana-wallet-adapter/dist/esm/core/fractal-wallet-adapter-impl.js");

//# sourceMappingURL=index.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmVuZG9ycy1ub2RlX21vZHVsZXNfZnJhY3RhbHdhZ21pX3NvbGFuYS13YWxsZXQtYWRhcHRlcl9kaXN0X2VzbV9pbmRleF9qcy5idW5kbGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0E7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0E7QUFDQSxnQ0FBZ0M7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0EsMkNBQTJDO0FBQzNDLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLDZDQUE2QztBQUM1RTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QjtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsWUFBWSxTQUFTO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQztBQUN0QywrQkFBK0I7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkI7QUFDM0I7QUFDQSwrQkFBK0IsNkNBQTZDO0FBQzVFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7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QUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw0R0FBZ0Q7QUFDMUUsMEJBQTBCLHlGQUE2QjtBQUN2RCwwQkFBMEIsbUZBQXVCO0FBQ2pELDBCQUEwQixrRkFBc0I7QUFDaEQsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsZ0ZBQXVCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7QUN0S087QUFDUCxjQUFjLGVBQWUsRUFBRSxlQUFlLEVBQUUsZUFBZTtBQUMvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7O0FDTnNEO0FBQ3REIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9zb2xhbmEtd2FsbGV0LWFkYXB0ZXIvbm9kZV9tb2R1bGVzL2Jhc2UteC9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9zb2xhbmEtd2FsbGV0LWFkYXB0ZXIvbm9kZV9tb2R1bGVzL2JzNTgvaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9wb3B1cC1jb25uZWN0aW9uL2Rpc3QvZXNtL2Nvbm5lY3Rpb24tbWFuYWdlci5qcyIsIndlYnBhY2s6Ly9jaXZpbC8uL25vZGVfbW9kdWxlcy9AZnJhY3RhbHdhZ21pL3BvcHVwLWNvbm5lY3Rpb24vZGlzdC9lc20vY29yZS9jb25uZWN0aW9uLmpzIiwid2VicGFjazovL2NpdmlsLy4vbm9kZV9tb2R1bGVzL0BmcmFjdGFsd2FnbWkvcG9wdXAtY29ubmVjdGlvbi9kaXN0L2VzbS9jb3JlL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9jaXZpbC8uL25vZGVfbW9kdWxlcy9AZnJhY3RhbHdhZ21pL3BvcHVwLWNvbm5lY3Rpb24vZGlzdC9lc20vY29yZS90eXBlcy5qcyIsIndlYnBhY2s6Ly9jaXZpbC8uL25vZGVfbW9kdWxlcy9AZnJhY3RhbHdhZ21pL3BvcHVwLWNvbm5lY3Rpb24vZGlzdC9lc20vY29yZS91dGlscy5qcyIsIndlYnBhY2s6Ly9jaXZpbC8uL25vZGVfbW9kdWxlcy9AZnJhY3RhbHdhZ21pL3BvcHVwLWNvbm5lY3Rpb24vZGlzdC9lc20vaW5kZXguanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9wb3B1cC1jb25uZWN0aW9uL2Rpc3QvZXNtL2xpYi9ndWFyZHMuanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9wb3B1cC1jb25uZWN0aW9uL2Rpc3QvZXNtL3BheWxvYWRzL2luZGV4LmpzIiwid2VicGFjazovL2NpdmlsLy4vbm9kZV9tb2R1bGVzL0BmcmFjdGFsd2FnbWkvcG9wdXAtY29ubmVjdGlvbi9kaXN0L2VzbS9wYXlsb2Fkcy9zb2xhbmEtd2FsbGV0LWFkYXB0ZXItYXBwcm92ZWQuanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9wb3B1cC1jb25uZWN0aW9uL2Rpc3QvZXNtL3BheWxvYWRzL3RyYW5zYWN0aW9uLXNpZ25hdHVyZS1uZWVkZWQtcmVzcG9uc2UuanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9wb3B1cC1jb25uZWN0aW9uL2Rpc3QvZXNtL3BheWxvYWRzL3RyYW5zYWN0aW9uLXNpZ25hdHVyZS1uZWVkZWQuanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9wb3B1cC1jb25uZWN0aW9uL2Rpc3QvZXNtL3VzZS1wb3B1cC1jb25uZWN0aW9uLmpzIiwid2VicGFjazovL2NpdmlsLy4vbm9kZV9tb2R1bGVzL0BmcmFjdGFsd2FnbWkvc29sYW5hLXdhbGxldC1hZGFwdGVyL2Rpc3QvZXNtL2NvcmUvZnJhY3RhbC13YWxsZXQtYWRhcHRlci1pbXBsLmpzIiwid2VicGFjazovL2NpdmlsLy4vbm9kZV9tb2R1bGVzL0BmcmFjdGFsd2FnbWkvc29sYW5hLXdhbGxldC1hZGFwdGVyL2Rpc3QvZXNtL2NvcmUvbm9uY2UuanMiLCJ3ZWJwYWNrOi8vY2l2aWwvLi9ub2RlX21vZHVsZXMvQGZyYWN0YWx3YWdtaS9zb2xhbmEtd2FsbGV0LWFkYXB0ZXIvZGlzdC9lc20vaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnXG4vLyBiYXNlLXggZW5jb2RpbmcgLyBkZWNvZGluZ1xuLy8gQ29weXJpZ2h0IChjKSAyMDE4IGJhc2UteCBjb250cmlidXRvcnNcbi8vIENvcHlyaWdodCAoYykgMjAxNC0yMDE4IFRoZSBCaXRjb2luIENvcmUgZGV2ZWxvcGVycyAoYmFzZTU4LmNwcClcbi8vIERpc3RyaWJ1dGVkIHVuZGVyIHRoZSBNSVQgc29mdHdhcmUgbGljZW5zZSwgc2VlIHRoZSBhY2NvbXBhbnlpbmdcbi8vIGZpbGUgTElDRU5TRSBvciBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocC5cbmZ1bmN0aW9uIGJhc2UgKEFMUEhBQkVUKSB7XG4gIGlmIChBTFBIQUJFVC5sZW5ndGggPj0gMjU1KSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0FscGhhYmV0IHRvbyBsb25nJykgfVxuICB2YXIgQkFTRV9NQVAgPSBuZXcgVWludDhBcnJheSgyNTYpXG4gIGZvciAodmFyIGogPSAwOyBqIDwgQkFTRV9NQVAubGVuZ3RoOyBqKyspIHtcbiAgICBCQVNFX01BUFtqXSA9IDI1NVxuICB9XG4gIGZvciAodmFyIGkgPSAwOyBpIDwgQUxQSEFCRVQubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgeCA9IEFMUEhBQkVULmNoYXJBdChpKVxuICAgIHZhciB4YyA9IHguY2hhckNvZGVBdCgwKVxuICAgIGlmIChCQVNFX01BUFt4Y10gIT09IDI1NSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKHggKyAnIGlzIGFtYmlndW91cycpIH1cbiAgICBCQVNFX01BUFt4Y10gPSBpXG4gIH1cbiAgdmFyIEJBU0UgPSBBTFBIQUJFVC5sZW5ndGhcbiAgdmFyIExFQURFUiA9IEFMUEhBQkVULmNoYXJBdCgwKVxuICB2YXIgRkFDVE9SID0gTWF0aC5sb2coQkFTRSkgLyBNYXRoLmxvZygyNTYpIC8vIGxvZyhCQVNFKSAvIGxvZygyNTYpLCByb3VuZGVkIHVwXG4gIHZhciBpRkFDVE9SID0gTWF0aC5sb2coMjU2KSAvIE1hdGgubG9nKEJBU0UpIC8vIGxvZygyNTYpIC8gbG9nKEJBU0UpLCByb3VuZGVkIHVwXG4gIGZ1bmN0aW9uIGVuY29kZSAoc291cmNlKSB7XG4gICAgaWYgKHNvdXJjZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHtcbiAgICB9IGVsc2UgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhzb3VyY2UpKSB7XG4gICAgICBzb3VyY2UgPSBuZXcgVWludDhBcnJheShzb3VyY2UuYnVmZmVyLCBzb3VyY2UuYnl0ZU9mZnNldCwgc291cmNlLmJ5dGVMZW5ndGgpXG4gICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHNvdXJjZSkpIHtcbiAgICAgIHNvdXJjZSA9IFVpbnQ4QXJyYXkuZnJvbShzb3VyY2UpXG4gICAgfVxuICAgIGlmICghKHNvdXJjZSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIFVpbnQ4QXJyYXknKSB9XG4gICAgaWYgKHNvdXJjZS5sZW5ndGggPT09IDApIHsgcmV0dXJuICcnIH1cbiAgICAgICAgLy8gU2tpcCAmIGNvdW50IGxlYWRpbmcgemVyb2VzLlxuICAgIHZhciB6ZXJvZXMgPSAwXG4gICAgdmFyIGxlbmd0aCA9IDBcbiAgICB2YXIgcGJlZ2luID0gMFxuICAgIHZhciBwZW5kID0gc291cmNlLmxlbmd0aFxuICAgIHdoaWxlIChwYmVnaW4gIT09IHBlbmQgJiYgc291cmNlW3BiZWdpbl0gPT09IDApIHtcbiAgICAgIHBiZWdpbisrXG4gICAgICB6ZXJvZXMrK1xuICAgIH1cbiAgICAgICAgLy8gQWxsb2NhdGUgZW5vdWdoIHNwYWNlIGluIGJpZy1lbmRpYW4gYmFzZTU4IHJlcHJlc2VudGF0aW9uLlxuICAgIHZhciBzaXplID0gKChwZW5kIC0gcGJlZ2luKSAqIGlGQUNUT1IgKyAxKSA+Pj4gMFxuICAgIHZhciBiNTggPSBuZXcgVWludDhBcnJheShzaXplKVxuICAgICAgICAvLyBQcm9jZXNzIHRoZSBieXRlcy5cbiAgICB3aGlsZSAocGJlZ2luICE9PSBwZW5kKSB7XG4gICAgICB2YXIgY2FycnkgPSBzb3VyY2VbcGJlZ2luXVxuICAgICAgICAgICAgLy8gQXBwbHkgXCJiNTggPSBiNTggKiAyNTYgKyBjaFwiLlxuICAgICAgdmFyIGkgPSAwXG4gICAgICBmb3IgKHZhciBpdDEgPSBzaXplIC0gMTsgKGNhcnJ5ICE9PSAwIHx8IGkgPCBsZW5ndGgpICYmIChpdDEgIT09IC0xKTsgaXQxLS0sIGkrKykge1xuICAgICAgICBjYXJyeSArPSAoMjU2ICogYjU4W2l0MV0pID4+PiAwXG4gICAgICAgIGI1OFtpdDFdID0gKGNhcnJ5ICUgQkFTRSkgPj4+IDBcbiAgICAgICAgY2FycnkgPSAoY2FycnkgLyBCQVNFKSA+Pj4gMFxuICAgICAgfVxuICAgICAgaWYgKGNhcnJ5ICE9PSAwKSB7IHRocm93IG5ldyBFcnJvcignTm9uLXplcm8gY2FycnknKSB9XG4gICAgICBsZW5ndGggPSBpXG4gICAgICBwYmVnaW4rK1xuICAgIH1cbiAgICAgICAgLy8gU2tpcCBsZWFkaW5nIHplcm9lcyBpbiBiYXNlNTggcmVzdWx0LlxuICAgIHZhciBpdDIgPSBzaXplIC0gbGVuZ3RoXG4gICAgd2hpbGUgKGl0MiAhPT0gc2l6ZSAmJiBiNThbaXQyXSA9PT0gMCkge1xuICAgICAgaXQyKytcbiAgICB9XG4gICAgICAgIC8vIFRyYW5zbGF0ZSB0aGUgcmVzdWx0IGludG8gYSBzdHJpbmcuXG4gICAgdmFyIHN0ciA9IExFQURFUi5yZXBlYXQoemVyb2VzKVxuICAgIGZvciAoOyBpdDIgPCBzaXplOyArK2l0MikgeyBzdHIgKz0gQUxQSEFCRVQuY2hhckF0KGI1OFtpdDJdKSB9XG4gICAgcmV0dXJuIHN0clxuICB9XG4gIGZ1bmN0aW9uIGRlY29kZVVuc2FmZSAoc291cmNlKSB7XG4gICAgaWYgKHR5cGVvZiBzb3VyY2UgIT09ICdzdHJpbmcnKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0V4cGVjdGVkIFN0cmluZycpIH1cbiAgICBpZiAoc291cmNlLmxlbmd0aCA9PT0gMCkgeyByZXR1cm4gbmV3IFVpbnQ4QXJyYXkoKSB9XG4gICAgdmFyIHBzeiA9IDBcbiAgICAgICAgLy8gU2tpcCBhbmQgY291bnQgbGVhZGluZyAnMSdzLlxuICAgIHZhciB6ZXJvZXMgPSAwXG4gICAgdmFyIGxlbmd0aCA9IDBcbiAgICB3aGlsZSAoc291cmNlW3Bzel0gPT09IExFQURFUikge1xuICAgICAgemVyb2VzKytcbiAgICAgIHBzeisrXG4gICAgfVxuICAgICAgICAvLyBBbGxvY2F0ZSBlbm91Z2ggc3BhY2UgaW4gYmlnLWVuZGlhbiBiYXNlMjU2IHJlcHJlc2VudGF0aW9uLlxuICAgIHZhciBzaXplID0gKCgoc291cmNlLmxlbmd0aCAtIHBzeikgKiBGQUNUT1IpICsgMSkgPj4+IDAgLy8gbG9nKDU4KSAvIGxvZygyNTYpLCByb3VuZGVkIHVwLlxuICAgIHZhciBiMjU2ID0gbmV3IFVpbnQ4QXJyYXkoc2l6ZSlcbiAgICAgICAgLy8gUHJvY2VzcyB0aGUgY2hhcmFjdGVycy5cbiAgICB3aGlsZSAoc291cmNlW3Bzel0pIHtcbiAgICAgICAgICAgIC8vIERlY29kZSBjaGFyYWN0ZXJcbiAgICAgIHZhciBjYXJyeSA9IEJBU0VfTUFQW3NvdXJjZS5jaGFyQ29kZUF0KHBzeildXG4gICAgICAgICAgICAvLyBJbnZhbGlkIGNoYXJhY3RlclxuICAgICAgaWYgKGNhcnJ5ID09PSAyNTUpIHsgcmV0dXJuIH1cbiAgICAgIHZhciBpID0gMFxuICAgICAgZm9yICh2YXIgaXQzID0gc2l6ZSAtIDE7IChjYXJyeSAhPT0gMCB8fCBpIDwgbGVuZ3RoKSAmJiAoaXQzICE9PSAtMSk7IGl0My0tLCBpKyspIHtcbiAgICAgICAgY2FycnkgKz0gKEJBU0UgKiBiMjU2W2l0M10pID4+PiAwXG4gICAgICAgIGIyNTZbaXQzXSA9IChjYXJyeSAlIDI1NikgPj4+IDBcbiAgICAgICAgY2FycnkgPSAoY2FycnkgLyAyNTYpID4+PiAwXG4gICAgICB9XG4gICAgICBpZiAoY2FycnkgIT09IDApIHsgdGhyb3cgbmV3IEVycm9yKCdOb24temVybyBjYXJyeScpIH1cbiAgICAgIGxlbmd0aCA9IGlcbiAgICAgIHBzeisrXG4gICAgfVxuICAgICAgICAvLyBTa2lwIGxlYWRpbmcgemVyb2VzIGluIGIyNTYuXG4gICAgdmFyIGl0NCA9IHNpemUgLSBsZW5ndGhcbiAgICB3aGlsZSAoaXQ0ICE9PSBzaXplICYmIGIyNTZbaXQ0XSA9PT0gMCkge1xuICAgICAgaXQ0KytcbiAgICB9XG4gICAgdmFyIHZjaCA9IG5ldyBVaW50OEFycmF5KHplcm9lcyArIChzaXplIC0gaXQ0KSlcbiAgICB2YXIgaiA9IHplcm9lc1xuICAgIHdoaWxlIChpdDQgIT09IHNpemUpIHtcbiAgICAgIHZjaFtqKytdID0gYjI1NltpdDQrK11cbiAgICB9XG4gICAgcmV0dXJuIHZjaFxuICB9XG4gIGZ1bmN0aW9uIGRlY29kZSAoc3RyaW5nKSB7XG4gICAgdmFyIGJ1ZmZlciA9IGRlY29kZVVuc2FmZShzdHJpbmcpXG4gICAgaWYgKGJ1ZmZlcikgeyByZXR1cm4gYnVmZmVyIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ05vbi1iYXNlJyArIEJBU0UgKyAnIGNoYXJhY3RlcicpXG4gIH1cbiAgcmV0dXJuIHtcbiAgICBlbmNvZGU6IGVuY29kZSxcbiAgICBkZWNvZGVVbnNhZmU6IGRlY29kZVVuc2FmZSxcbiAgICBkZWNvZGU6IGRlY29kZVxuICB9XG59XG5tb2R1bGUuZXhwb3J0cyA9IGJhc2VcbiIsImNvbnN0IGJhc2V4ID0gcmVxdWlyZSgnYmFzZS14JylcbmNvbnN0IEFMUEhBQkVUID0gJzEyMzQ1Njc4OUFCQ0RFRkdISktMTU5QUVJTVFVWV1hZWmFiY2RlZmdoaWprbW5vcHFyc3R1dnd4eXonXG5cbm1vZHVsZS5leHBvcnRzID0gYmFzZXgoQUxQSEFCRVQpXG4iLCJpbXBvcnQgeyBDb25uZWN0aW9uIH0gZnJvbSBcIi4vY29yZS9jb25uZWN0aW9uLmpzXCI7XG5pbXBvcnQgeyBERUZBVUxUX1BPUFVQX0hFSUdIVF9QWCwgREVGQVVMVF9QT1BVUF9XSURUSF9QWCwgfSBmcm9tIFwiLi9jb3JlL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IHsgUG9wdXBFdmVudCB9IGZyb20gXCIuL2NvcmUvdHlwZXMuanNcIjtcbmltcG9ydCB7IG9wZW5Qb3B1cCwgdmFsaWRhdGVPcmlnaW4gfSBmcm9tIFwiLi9jb3JlL3V0aWxzLmpzXCI7XG5leHBvcnQgY2xhc3MgQ29ubmVjdGlvbk1hbmFnZXIge1xuICAgIGNvbnN0cnVjdG9yKHBsYXRmb3JtKSB7XG4gICAgICAgIHRoaXMucGxhdGZvcm0gPSBwbGF0Zm9ybTtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcbiAgICAgICAgdGhpcy5wb3B1cFdpbmRvdyA9IG51bGw7XG4gICAgICAgIHRoaXMuaGFuZGxlTWVzc2FnZSA9IChlKSA9PiB7XG4gICAgICAgICAgICB2YXIgX2EsIF9iO1xuICAgICAgICAgICAgaWYgKCF2YWxpZGF0ZU9yaWdpbihlLm9yaWdpbikpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCB2YWxpZGF0ZWRPcmlnaW4gPSBlLm9yaWdpbjtcbiAgICAgICAgICAgIGlmICghdGhpcy5wb3B1cFdpbmRvdykge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmRhdGEuZXZlbnQgPT09IFBvcHVwRXZlbnQuSEFORFNIQUtFICYmICF0aGlzLmNvbm5lY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBpZiAoIXRoaXMudmVyaWZ5QW5kUmVzZXROb25jZSgoX2EgPSBlLmRhdGEucGF5bG9hZCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLm5vbmNlKSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMucG9wdXBXaW5kb3cucG9zdE1lc3NhZ2Uoe1xuICAgICAgICAgICAgICAgICAgICBldmVudDogUG9wdXBFdmVudC5IQU5EU0hBS0VfQUNLLFxuICAgICAgICAgICAgICAgICAgICBwYXlsb2FkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBwbGF0Zm9ybTogdGhpcy5wbGF0Zm9ybSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICB9LCB2YWxpZGF0ZWRPcmlnaW4pO1xuICAgICAgICAgICAgICAgIHRoaXMuY29ubmVjdGlvbiA9IG5ldyBDb25uZWN0aW9uKHZhbGlkYXRlZE9yaWdpbiwgdGhpcy5wb3B1cFdpbmRvdyk7XG4gICAgICAgICAgICAgICAgKF9iID0gdGhpcy5jb25uZWN0aW9uVXBkYXRlZENhbGxiYWNrKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbCh0aGlzLCB0aGlzLmNvbm5lY3Rpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCF0aGlzLmNvbm5lY3Rpb24pIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmNvbm5lY3Rpb24ucnVuSGFuZGxlcnNGb3JFdmVudChlLmRhdGEuZXZlbnQsIGUuZGF0YS5wYXlsb2FkKTtcbiAgICAgICAgICAgIGlmIChlLmRhdGEuZXZlbnQgPT09IFBvcHVwRXZlbnQuUE9QVVBfQ0xPU0VEICYmIHRoaXMuY29ubmVjdGlvbikge1xuICAgICAgICAgICAgICAgIHRoaXMucmVzZXRDb25uZWN0aW9uKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cFdpbmRvdyA9IG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgfVxuICAgIGluaXRpYWxpemUoKSB7XG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgdGhpcy5oYW5kbGVNZXNzYWdlKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHRlYXJEb3duKCkge1xuICAgICAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcignbWVzc2FnZScsIHRoaXMuaGFuZGxlTWVzc2FnZSk7XG4gICAgICAgIHRoaXMucmVzZXRDb25uZWN0aW9uKCk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBvcGVuKHsgdXJsLCB3aWR0aFB4ID0gREVGQVVMVF9QT1BVUF9XSURUSF9QWCwgaGVpZ2h0UHggPSBERUZBVUxUX1BPUFVQX0hFSUdIVF9QWCwgbm9uY2UsIH0pIHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICBpZiAoKF9hID0gdGhpcy5wb3B1cFdpbmRvdykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmNsb3NlZCkge1xuICAgICAgICAgICAgdGhpcy5yZXNldENvbm5lY3Rpb25BbmRQb3B1cFdpbmRvdygpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnBvcHVwV2luZG93KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0aWFsaXplKCk7XG4gICAgICAgIGlmIChub25jZSkge1xuICAgICAgICAgICAgdGhpcy5ub25jZSA9IG5vbmNlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGxlZnQgPSB3aW5kb3cuc2NyZWVuWCArICh3aW5kb3cuaW5uZXJXaWR0aCAtIHdpZHRoUHgpIC8gMjtcbiAgICAgICAgY29uc3QgdG9wID0gd2luZG93LnNjcmVlblkgKyAod2luZG93LmlubmVySGVpZ2h0IC0gaGVpZ2h0UHgpIC8gMjtcbiAgICAgICAgdGhpcy5wb3B1cFdpbmRvdyA9IG9wZW5Qb3B1cCh7XG4gICAgICAgICAgICBoZWlnaHQ6IGhlaWdodFB4LFxuICAgICAgICAgICAgbGVmdCxcbiAgICAgICAgICAgIHRvcCxcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHdpZHRoOiB3aWR0aFB4LFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2xvc2UoKSB7XG4gICAgICAgIGlmICghdGhpcy5wb3B1cFdpbmRvdykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucG9wdXBXaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgdGhpcy5yZXNldENvbm5lY3Rpb25BbmRQb3B1cFdpbmRvdygpO1xuICAgIH1cbiAgICBvbkNvbm5lY3Rpb25VcGRhdGVkKGNhbGxiYWNrKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdGlvblVwZGF0ZWRDYWxsYmFjayA9IGNhbGxiYWNrO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgZ2V0Q29ubmVjdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuY29ubmVjdGlvbjtcbiAgICB9XG4gICAgcmVzZXRDb25uZWN0aW9uQW5kUG9wdXBXaW5kb3coKSB7XG4gICAgICAgIHRoaXMucmVzZXRDb25uZWN0aW9uKCk7XG4gICAgICAgIHRoaXMucG9wdXBXaW5kb3cgPSBudWxsO1xuICAgIH1cbiAgICByZXNldENvbm5lY3Rpb24oKSB7XG4gICAgICAgIHZhciBfYSwgX2I7XG4gICAgICAgIChfYSA9IHRoaXMuY29ubmVjdGlvbikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnJlc2V0SGFuZGxlcnMoKTtcbiAgICAgICAgdGhpcy5jb25uZWN0aW9uID0gbnVsbDtcbiAgICAgICAgKF9iID0gdGhpcy5jb25uZWN0aW9uVXBkYXRlZENhbGxiYWNrKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuY2FsbCh0aGlzLCB0aGlzLmNvbm5lY3Rpb24pO1xuICAgIH1cbiAgICB2ZXJpZnlBbmRSZXNldE5vbmNlKHVuY2hlY2tlZE5vbmNlKSB7XG4gICAgICAgIGlmICghdGhpcy5ub25jZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gdW5jaGVja2VkTm9uY2UgPT09IHRoaXMubm9uY2U7XG4gICAgICAgIGlmIChyZXN1bHQpIHtcbiAgICAgICAgICAgIHRoaXMubm9uY2UgPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25uZWN0aW9uLW1hbmFnZXIuanMubWFwIiwiZXhwb3J0IGNsYXNzIENvbm5lY3Rpb24ge1xuICAgIGNvbnN0cnVjdG9yKHZhbGlkYXRlZE9yaWdpbiwgdGFyZ2V0V2luZG93KSB7XG4gICAgICAgIHRoaXMudmFsaWRhdGVkT3JpZ2luID0gdmFsaWRhdGVkT3JpZ2luO1xuICAgICAgICB0aGlzLnRhcmdldFdpbmRvdyA9IHRhcmdldFdpbmRvdztcbiAgICAgICAgdGhpcy5oYW5kbGVycyA9IG5ldyBNYXAoKTtcbiAgICB9XG4gICAgb2ZmKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICBjb25zdCBldmVudENhbGxiYWNrcyA9IHRoaXMuaGFuZGxlcnMuZ2V0KGV2ZW50KTtcbiAgICAgICAgZXZlbnRDYWxsYmFja3MgPT09IG51bGwgfHwgZXZlbnRDYWxsYmFja3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGV2ZW50Q2FsbGJhY2tzLmRlbGV0ZShjYWxsYmFjayk7XG4gICAgfVxuICAgIG9uKGV2ZW50LCBjYWxsYmFjaykge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGV2ZW50Q2FsbGJhY2tzID0gKF9hID0gdGhpcy5oYW5kbGVycy5nZXQoZXZlbnQpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBuZXcgU2V0KCk7XG4gICAgICAgIGV2ZW50Q2FsbGJhY2tzLmFkZChjYWxsYmFjayk7XG4gICAgICAgIHRoaXMuaGFuZGxlcnMuc2V0KGV2ZW50LCBldmVudENhbGxiYWNrcyk7XG4gICAgfVxuICAgIHNlbmQoeyBldmVudCwgcGF5bG9hZCB9KSB7XG4gICAgICAgIHRoaXMudGFyZ2V0V2luZG93LnBvc3RNZXNzYWdlKHtcbiAgICAgICAgICAgIGV2ZW50LFxuICAgICAgICAgICAgcGF5bG9hZCxcbiAgICAgICAgfSwgdGhpcy52YWxpZGF0ZWRPcmlnaW4pO1xuICAgIH1cbiAgICBydW5IYW5kbGVyc0ZvckV2ZW50KGV2ZW50LCBwYXlsb2FkKSB7XG4gICAgICAgIGNvbnN0IGV2ZW50Q2FsbGJhY2tzID0gdGhpcy5oYW5kbGVycy5nZXQoZXZlbnQpO1xuICAgICAgICBpZiAoIWV2ZW50Q2FsbGJhY2tzKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgZm9yIChjb25zdCBjYWxsYmFjayBvZiBldmVudENhbGxiYWNrcykge1xuICAgICAgICAgICAgY2FsbGJhY2socGF5bG9hZCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmVzZXRIYW5kbGVycygpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVycy5jbGVhcigpO1xuICAgIH1cbiAgICBleHBvcnQoKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvZmY6IHRoaXMub2ZmLmJpbmQodGhpcyksXG4gICAgICAgICAgICBvbjogdGhpcy5vbi5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgc2VuZDogdGhpcy5zZW5kLmJpbmQodGhpcyksXG4gICAgICAgICAgICB2YWxpZGF0ZWRPcmlnaW46IHRoaXMudmFsaWRhdGVkT3JpZ2luLFxuICAgICAgICB9O1xuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbm5lY3Rpb24uanMubWFwIiwiZXhwb3J0IGNvbnN0IEZSQUNUQUxfRE9NQUlOID0gJ2ZyYWN0YWwuaXMnO1xuZXhwb3J0IGNvbnN0IEZSQUNUQUxfRE9NQUlOX0hUVFBTID0gJ2h0dHBzOi8vZnJhY3RhbC5pcyc7XG5leHBvcnQgY29uc3QgRlJBQ1RBTF9ET01BSU5fSFRUUFNfV1dXID0gJ2h0dHBzOi8vd3d3LmZyYWN0YWwuaXMnO1xuZXhwb3J0IGNvbnN0IERFRkFVTFRfUE9QVVBfV0lEVEhfUFggPSA0MDA7XG5leHBvcnQgY29uc3QgREVGQVVMVF9QT1BVUF9IRUlHSFRfUFggPSA2MDA7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25zdGFudHMuanMubWFwIiwiZXhwb3J0IHZhciBQb3B1cEV2ZW50O1xuKGZ1bmN0aW9uIChQb3B1cEV2ZW50KSB7XG4gICAgUG9wdXBFdmVudFtcIlBST0pFQ1RfQVBQUk9WRURcIl0gPSBcIlBST0pFQ1RfQVBQUk9WRURcIjtcbiAgICBQb3B1cEV2ZW50W1wiSEFORFNIQUtFXCJdID0gXCJIQU5EU0hBS0VcIjtcbiAgICBQb3B1cEV2ZW50W1wiSEFORFNIQUtFX0FDS1wiXSA9IFwiSEFORFNIQUtFX0FDS1wiO1xuICAgIFBvcHVwRXZlbnRbXCJTSUdORURfVFJBTlNBQ1RJT05cIl0gPSBcIlNJR05FRF9UUkFOU0FDVElPTlwiO1xuICAgIFBvcHVwRXZlbnRbXCJGQUlMRURfVE9fU0lHTl9UUkFOU0FDVElPTlwiXSA9IFwiRkFJTEVEX1RPX1NJR05fVFJBTlNBQ1RJT05cIjtcbiAgICBQb3B1cEV2ZW50W1wiVFJBTlNBQ1RJT05fREVOSUVEXCJdID0gXCJUUkFOU0FDVElPTl9ERU5JRURcIjtcbiAgICBQb3B1cEV2ZW50W1wiU09MQU5BX1dBTExFVF9BREFQVEVSX0FQUFJPVkVEXCJdID0gXCJTT0xBTkFfV0FMTEVUX0FEQVBURVJfQVBQUk9WRURcIjtcbiAgICBQb3B1cEV2ZW50W1wiU09MQU5BX1dBTExFVF9BREFQVEVSX0RFTklFRFwiXSA9IFwiU09MQU5BX1dBTExFVF9BREFQVEVSX0RFTklFRFwiO1xuICAgIFBvcHVwRXZlbnRbXCJQT1BVUF9DTE9TRURcIl0gPSBcIlBPUFVQX0NMT1NFRFwiO1xuICAgIFBvcHVwRXZlbnRbXCJUUkFOU0FDVElPTl9TSUdOQVRVUkVfTkVFREVEXCJdID0gXCJUUkFOU0FDVElPTl9TSUdOQVRVUkVfTkVFREVEXCI7XG4gICAgUG9wdXBFdmVudFtcIlRSQU5TQUNUSU9OX1NJR05BVFVSRV9ORUVERURfUkVTUE9OU0VcIl0gPSBcIlRSQU5TQUNUSU9OX1NJR05BVFVSRV9ORUVERURfUkVTUE9OU0VcIjtcbiAgICBQb3B1cEV2ZW50W1wiQVVUSF9MT0FERURcIl0gPSBcIkFVVEhfTE9BREVEXCI7XG59KShQb3B1cEV2ZW50IHx8IChQb3B1cEV2ZW50ID0ge30pKTtcbmV4cG9ydCB2YXIgUGxhdGZvcm07XG4oZnVuY3Rpb24gKFBsYXRmb3JtKSB7XG4gICAgUGxhdGZvcm1bXCJVTktOT1dOXCJdID0gXCJVTktOT1dOXCI7XG4gICAgUGxhdGZvcm1bXCJSRUFDVF9TREtcIl0gPSBcIlJFQUNUX1NES1wiO1xuICAgIFBsYXRmb3JtW1wiU09MQU5BX1dBTExFVF9BREFQVEVSXCJdID0gXCJTT0xBTkFfV0FMTEVUX0FEQVBURVJcIjtcbn0pKFBsYXRmb3JtIHx8IChQbGF0Zm9ybSA9IHt9KSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD10eXBlcy5qcy5tYXAiLCJpbXBvcnQgeyBGUkFDVEFMX0RPTUFJTl9IVFRQU19XV1csIEZSQUNUQUxfRE9NQUlOX0hUVFBTLCBERUZBVUxUX1BPUFVQX0hFSUdIVF9QWCwgfSBmcm9tIFwiLi9jb25zdGFudHMuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZU9yaWdpbihvcmlnaW4pIHtcbiAgICByZXR1cm4gb3JpZ2luID09PSBGUkFDVEFMX0RPTUFJTl9IVFRQU19XV1cgfHwgb3JpZ2luID09PSBGUkFDVEFMX0RPTUFJTl9IVFRQUztcbn1cbmNvbnN0IFRBUkdFVCA9ICdmcmFjdGFsOmFwcHJvdmFsOnBvcHVwJztcbmNvbnN0IFNUQVRJQ19QT1BVUF9GRUFUVVJFUyA9IFsncmVzaXphYmxlJywgJ3Njcm9sbGJhcnM9MScsICdzdGF0dXM9MSddO1xuZXhwb3J0IGZ1bmN0aW9uIG9wZW5Qb3B1cCh7IGxlZnQgPSAwLCBzY29wZSA9IHdpbmRvdywgdG9wID0gMCwgd2lkdGggPSBERUZBVUxUX1BPUFVQX0hFSUdIVF9QWCwgaGVpZ2h0ID0gREVGQVVMVF9QT1BVUF9IRUlHSFRfUFgsIHVybCwgfSkge1xuICAgIHJldHVybiBzY29wZS5vcGVuKHVybCwgVEFSR0VULCBnZXRQb3B1cEZlYXR1cmVzKHsgaGVpZ2h0LCBsZWZ0LCB0b3AsIHdpZHRoIH0pKTtcbn1cbmZ1bmN0aW9uIGdldFBvcHVwRmVhdHVyZXMoeyBoZWlnaHQsIGxlZnQsIHRvcCwgd2lkdGgsIH0pIHtcbiAgICByZXR1cm4gW1xuICAgICAgICAncG9wdXAnLFxuICAgICAgICBgbGVmdD0ke2xlZnR9YCxcbiAgICAgICAgYHRvcD0ke3RvcH1gLFxuICAgICAgICBgd2lkdGg9JHt3aWR0aH1gLFxuICAgICAgICBgaGVpZ2h0PSR7aGVpZ2h0fWAsXG4gICAgICAgIC4uLlNUQVRJQ19QT1BVUF9GRUFUVVJFUyxcbiAgICBdLmpvaW4oJywnKTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXV0aWxzLmpzLm1hcCIsImV4cG9ydCB7IFBvcHVwRXZlbnQsIFBsYXRmb3JtIH0gZnJvbSBcIi4vY29yZS90eXBlcy5qc1wiO1xuZXhwb3J0IHsgQ29ubmVjdGlvbiB9IGZyb20gXCIuL2NvcmUvY29ubmVjdGlvbi5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vdXNlLXBvcHVwLWNvbm5lY3Rpb24uanNcIjtcbmV4cG9ydCAqIGZyb20gXCIuL2Nvbm5lY3Rpb24tbWFuYWdlci5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vcGF5bG9hZHMvaW5kZXguanNcIjtcbmV4cG9ydCB7IERFRkFVTFRfUE9QVVBfSEVJR0hUX1BYLCBERUZBVUxUX1BPUFVQX1dJRFRIX1BYLCB9IGZyb20gXCIuL2NvcmUvY29uc3RhbnRzLmpzXCI7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC5qcy5tYXAiLCJleHBvcnQgZnVuY3Rpb24gaXNPYmplY3QodmFsdWUpIHtcbiAgICBpZiAodmFsdWUgPT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Z3VhcmRzLmpzLm1hcCIsImV4cG9ydCAqIGZyb20gXCIuL3NvbGFuYS13YWxsZXQtYWRhcHRlci1hcHByb3ZlZC5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vdHJhbnNhY3Rpb24tc2lnbmF0dXJlLW5lZWRlZC5qc1wiO1xuZXhwb3J0ICogZnJvbSBcIi4vdHJhbnNhY3Rpb24tc2lnbmF0dXJlLW5lZWRlZC1yZXNwb25zZS5qc1wiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIiwiaW1wb3J0IHsgaXNPYmplY3QgfSBmcm9tIFwiLi4vbGliL2d1YXJkcy5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIGFzc2VydFBheWxvYWRJc1NvbGFuYVdhbGxldEFkYXB0ZXJBcHByb3ZlZChwYXlsb2FkKSB7XG4gICAgaWYgKCFpc09iamVjdChwYXlsb2FkKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICghKCdzb2xhbmFQdWJsaWNLZXknIGluIHBheWxvYWQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBwYXlsb2FkLnNvbGFuYVB1YmxpY0tleSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNvbGFuYS13YWxsZXQtYWRhcHRlci1hcHByb3ZlZC5qcy5tYXAiLCJpbXBvcnQgeyBpc09iamVjdCB9IGZyb20gXCIuLi9saWIvZ3VhcmRzLmpzXCI7XG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0UGF5bG9hZElzVHJhbnNhY3Rpb25TaWduYXR1cmVOZWVkZWRSZXNwb25zZVBheWxvYWQocGF5bG9hZCkge1xuICAgIGlmICghaXNPYmplY3QocGF5bG9hZCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoISgnc2lnbmVkQjU4VHJhbnNhY3Rpb25zJyBpbiBwYXlsb2FkKSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGlmICghQXJyYXkuaXNBcnJheShwYXlsb2FkLnNpZ25lZEI1OFRyYW5zYWN0aW9ucykpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gcGF5bG9hZC5zaWduZWRCNThUcmFuc2FjdGlvbnMuZXZlcnkodmFsdWUgPT4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10cmFuc2FjdGlvbi1zaWduYXR1cmUtbmVlZGVkLXJlc3BvbnNlLmpzLm1hcCIsImltcG9ydCB7IGlzT2JqZWN0IH0gZnJvbSBcIi4uL2xpYi9ndWFyZHMuanNcIjtcbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnRQYXlsb2FkSXNUcmFuc2FjdGlvblNpZ25hdHVyZU5lZWRlZFBheWxvYWQocGF5bG9hZCkge1xuICAgIGlmICghaXNPYmplY3QocGF5bG9hZCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoISgndW5zaWduZWRCNThUcmFuc2FjdGlvbnMnIGluIHBheWxvYWQpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHBheWxvYWQudW5zaWduZWRCNThUcmFuc2FjdGlvbnMpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHBheWxvYWQudW5zaWduZWRCNThUcmFuc2FjdGlvbnMuZXZlcnkodmFsdWUgPT4gdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD10cmFuc2FjdGlvbi1zaWduYXR1cmUtbmVlZGVkLmpzLm1hcCIsImltcG9ydCB7IENvbm5lY3Rpb25NYW5hZ2VyIH0gZnJvbSBcIi4vY29ubmVjdGlvbi1tYW5hZ2VyLmpzXCI7XG5pbXBvcnQgeyBERUZBVUxUX1BPUFVQX1dJRFRIX1BYLCBERUZBVUxUX1BPUFVQX0hFSUdIVF9QWCwgfSBmcm9tIFwiLi9jb3JlL2NvbnN0YW50cy5qc1wiO1xuaW1wb3J0IHsgUGxhdGZvcm0gfSBmcm9tIFwiLi9jb3JlL3R5cGVzLmpzXCI7XG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuZXhwb3J0IGNvbnN0IHVzZVBvcHVwQ29ubmVjdGlvbiA9ICh7IGVuYWJsZWQgPSB0cnVlLCBwbGF0Zm9ybSA9IFBsYXRmb3JtLlVOS05PV04sIHdpZHRoUHggPSBERUZBVUxUX1BPUFVQX1dJRFRIX1BYLCBoZWlnaHRQeCA9IERFRkFVTFRfUE9QVVBfSEVJR0hUX1BYLCB9ID0ge30pID0+IHtcbiAgICBjb25zdCBbZXhwb3J0ZWRDb25uZWN0aW9uLCBzZXRFeHBvcnRlZENvbm5lY3Rpb25dID0gdXNlU3RhdGUodW5kZWZpbmVkKTtcbiAgICBjb25zdCBjb25uZWN0aW9uTWFuYWdlclJlZiA9IHVzZVJlZihuZXcgQ29ubmVjdGlvbk1hbmFnZXIocGxhdGZvcm0pLm9uQ29ubmVjdGlvblVwZGF0ZWQoKGNvbm5lY3Rpb24pID0+IHtcbiAgICAgICAgc2V0RXhwb3J0ZWRDb25uZWN0aW9uKGNvbm5lY3Rpb24gPT09IG51bGwgfHwgY29ubmVjdGlvbiA9PT0gdm9pZCAwID8gdm9pZCAwIDogY29ubmVjdGlvbi5leHBvcnQoKSk7XG4gICAgfSkpO1xuICAgIGNvbnN0IG9wZW4gPSB1c2VDYWxsYmFjaygodXJsKSA9PiB7XG4gICAgICAgIGNvbm5lY3Rpb25NYW5hZ2VyUmVmLmN1cnJlbnQub3Blbih7XG4gICAgICAgICAgICBoZWlnaHRQeCxcbiAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgIHdpZHRoUHgsXG4gICAgICAgIH0pO1xuICAgIH0sIFtjb25uZWN0aW9uTWFuYWdlclJlZiwgd2lkdGhQeCwgaGVpZ2h0UHhdKTtcbiAgICBjb25zdCBjbG9zZSA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICAgICAgY29ubmVjdGlvbk1hbmFnZXJSZWYuY3VycmVudC5jbG9zZSgpO1xuICAgIH0sIFtjb25uZWN0aW9uTWFuYWdlclJlZl0pO1xuICAgIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgICAgIGlmIChlbmFibGVkKSB7XG4gICAgICAgICAgICBjb25uZWN0aW9uTWFuYWdlclJlZi5jdXJyZW50LmluaXRpYWxpemUoKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIGNvbm5lY3Rpb25NYW5hZ2VyUmVmLmN1cnJlbnQudGVhckRvd24oKTtcbiAgICAgICAgfVxuICAgIH0sIFtjb25uZWN0aW9uTWFuYWdlclJlZl0pO1xuICAgIHJldHVybiB7XG4gICAgICAgIGNsb3NlLFxuICAgICAgICBjb25uZWN0aW9uOiBleHBvcnRlZENvbm5lY3Rpb24sXG4gICAgICAgIG9wZW4sXG4gICAgfTtcbn07XG4vLyMgc291cmNlTWFwcGluZ1VSTD11c2UtcG9wdXAtY29ubmVjdGlvbi5qcy5tYXAiLCJpbXBvcnQgeyBDb25uZWN0aW9uTWFuYWdlciwgUGxhdGZvcm0sIFBvcHVwRXZlbnQsIGFzc2VydFBheWxvYWRJc1NvbGFuYVdhbGxldEFkYXB0ZXJBcHByb3ZlZCwgREVGQVVMVF9QT1BVUF9IRUlHSFRfUFgsIGFzc2VydFBheWxvYWRJc1RyYW5zYWN0aW9uU2lnbmF0dXJlTmVlZGVkUmVzcG9uc2VQYXlsb2FkLCB9IGZyb20gJ0BmcmFjdGFsd2FnbWkvcG9wdXAtY29ubmVjdGlvbic7XG5pbXBvcnQgeyBXYWxsZXRFcnJvciwgV2FsbGV0Tm90Q29ubmVjdGVkRXJyb3IsIFdhbGxldFNpZ25UcmFuc2FjdGlvbkVycm9yLCBXYWxsZXRQdWJsaWNLZXlFcnJvciwgV2FsbGV0Q29ubmVjdGlvbkVycm9yLCB9IGZyb20gJ0Bzb2xhbmEvd2FsbGV0LWFkYXB0ZXItYmFzZSc7XG5pbXBvcnQgeyBUcmFuc2FjdGlvbiwgUHVibGljS2V5IH0gZnJvbSAnQHNvbGFuYS93ZWIzLmpzJztcbmltcG9ydCBiYXNlNTggZnJvbSAnYnM1OCc7XG5pbXBvcnQgeyBjcmVhdGVOb25jZSB9IGZyb20gXCIuL25vbmNlLmpzXCI7XG5jb25zdCBVTktOT1dOX0VSUk9SX01FU1NBR0UgPSAnVW5rbm93biBFcnJvcic7XG5jb25zdCBGUkFDVEFMX0RPTUFJTl9IVFRQUyA9ICdodHRwczovL2ZyYWN0YWwuaXMnO1xuY29uc3QgQVBQUk9WRV9QQUdFX1VSTCA9IGAke0ZSQUNUQUxfRE9NQUlOX0hUVFBTfS93YWxsZXQtYWRhcHRlci9hcHByb3ZlYDtcbmNvbnN0IFNJR05fUEFHRV9VUkwgPSBgJHtGUkFDVEFMX0RPTUFJTl9IVFRQU30vd2FsbGV0LWFkYXB0ZXIvc2lnbmA7XG5jb25zdCBNSU5fUE9QVVBfSEVJR0hUX1BYID0gREVGQVVMVF9QT1BVUF9IRUlHSFRfUFg7XG5jb25zdCBNQVhfUE9QVVBfV0lEVEhfUFggPSA4NTA7XG5jb25zdCBMT0NBTF9TVE9SQUdFX0tFWV9GT1JfUFVCTElDX0tFWSA9ICdSZHhxTll4Ric7XG5leHBvcnQgY2xhc3MgRnJhY3RhbFdhbGxldEFkYXB0ZXJJbXBsIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5wb3B1cE1hbmFnZXIgPSBuZXcgQ29ubmVjdGlvbk1hbmFnZXIoUGxhdGZvcm0uU09MQU5BX1dBTExFVF9BREFQVEVSKTtcbiAgICAgICAgdGhpcy5wdWJsaWNLZXkgPSBudWxsO1xuICAgICAgICB0aGlzLmNvbm5lY3RpbmcgPSBmYWxzZTtcbiAgICB9XG4gICAgZ2V0UHVibGljS2V5KCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wdWJsaWNLZXk7XG4gICAgfVxuICAgIGFzeW5jIGNvbm5lY3QoKSB7XG4gICAgICAgIGxldCByZXNvbHZlO1xuICAgICAgICBsZXQgcmVqZWN0O1xuICAgICAgICBjb25zdCBwdWJsaWNLZXlJbkxvY2FsU3RvcmFnZSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShMT0NBTF9TVE9SQUdFX0tFWV9GT1JfUFVCTElDX0tFWSk7XG4gICAgICAgIGlmIChwdWJsaWNLZXlJbkxvY2FsU3RvcmFnZSkge1xuICAgICAgICAgICAgdGhpcy5wdWJsaWNLZXkgPSBuZXcgUHVibGljS2V5KHB1YmxpY0tleUluTG9jYWxTdG9yYWdlKTtcbiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBub25jZSA9IGNyZWF0ZU5vbmNlKCk7XG4gICAgICAgIHRoaXMucG9wdXBNYW5hZ2VyLm9wZW4oe1xuICAgICAgICAgICAgbm9uY2UsXG4gICAgICAgICAgICB1cmw6IGAke0FQUFJPVkVfUEFHRV9VUkx9LyR7bm9uY2V9YCxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGhhbmRsZVNvbGFuYVdhbGxldEFkYXB0ZXJBcHByb3ZlZCA9IChwYXlsb2FkKSA9PiB7XG4gICAgICAgICAgICBpZiAoIWFzc2VydFBheWxvYWRJc1NvbGFuYVdhbGxldEFkYXB0ZXJBcHByb3ZlZChwYXlsb2FkKSkge1xuICAgICAgICAgICAgICAgIHJlamVjdChuZXcgV2FsbGV0Q29ubmVjdGlvbkVycm9yKCdNYWxmb3JtZWQgcGF5bG9hZCB3aGVuIHNldHRpbmcgdXAgY29ubmVjdGlvbi4gJyArXG4gICAgICAgICAgICAgICAgICAgICdFeHBlY3RlZCB7IHNvbGFuYVB1YmxpY0tleTogc3RyaW5nIH0gYnV0ICcgK1xuICAgICAgICAgICAgICAgICAgICBgcmVjZWl2ZWQgJHtKU09OLnN0cmluZ2lmeShwYXlsb2FkKX1gKSk7XG4gICAgICAgICAgICAgICAgdGhpcy5wb3B1cE1hbmFnZXIuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHRoaXMucHVibGljS2V5ID0gbmV3IFB1YmxpY0tleShwYXlsb2FkLnNvbGFuYVB1YmxpY0tleSk7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5zZXRJdGVtKExPQ0FMX1NUT1JBR0VfS0VZX0ZPUl9QVUJMSUNfS0VZLCBwYXlsb2FkLnNvbGFuYVB1YmxpY0tleSk7XG4gICAgICAgICAgICAgICAgcmVzb2x2ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHVibGljS2V5RXJyb3IgPSBuZXcgV2FsbGV0UHVibGljS2V5RXJyb3IoZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBVTktOT1dOX0VSUk9SX01FU1NBR0UsIGVycm9yKTtcbiAgICAgICAgICAgICAgICByZWplY3QocHVibGljS2V5RXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5wb3B1cE1hbmFnZXIuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgaGFuZGxlRXhwbGljaXREZW5pYWxCeVVzZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICByZWplY3QobmV3IFdhbGxldENvbm5lY3Rpb25FcnJvcignVGhlIHVzZXIgZGVuaWVkIHRoZSBjb25uZWN0aW9uLicpKTtcbiAgICAgICAgICAgIHRoaXMucG9wdXBNYW5hZ2VyLmNsb3NlKCk7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGhhbmRsZUNsb3NlZEJ5VXNlciA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgV2FsbGV0Q29ubmVjdGlvbkVycm9yKCdUaGUgdXNlciBkZW5pZWQgdGhlIGNvbm5lY3Rpb24uJykpO1xuICAgICAgICAgICAgdGhpcy5wb3B1cE1hbmFnZXIuY2xvc2UoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5wb3B1cE1hbmFnZXIub25Db25uZWN0aW9uVXBkYXRlZChjb25uZWN0aW9uID0+IHtcbiAgICAgICAgICAgIGlmICghY29ubmVjdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbm5lY3Rpb24ub24oUG9wdXBFdmVudC5TT0xBTkFfV0FMTEVUX0FEQVBURVJfQVBQUk9WRUQsIGhhbmRsZVNvbGFuYVdhbGxldEFkYXB0ZXJBcHByb3ZlZCk7XG4gICAgICAgICAgICBjb25uZWN0aW9uLm9uKFBvcHVwRXZlbnQuU09MQU5BX1dBTExFVF9BREFQVEVSX0RFTklFRCwgaGFuZGxlRXhwbGljaXREZW5pYWxCeVVzZXIpO1xuICAgICAgICAgICAgY29ubmVjdGlvbi5vbihQb3B1cEV2ZW50LlBPUFVQX0NMT1NFRCwgaGFuZGxlQ2xvc2VkQnlVc2VyKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBuZXcgUHJvbWlzZSgocHJvbWlzZVJlc29sdmVyLCBwcm9taXNlUmVqZWN0b3IpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUgPSBwcm9taXNlUmVzb2x2ZXI7XG4gICAgICAgICAgICByZWplY3QgPSBwcm9taXNlUmVqZWN0b3I7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyBkaXNjb25uZWN0KCkge1xuICAgICAgICB0aGlzLnBvcHVwTWFuYWdlci50ZWFyRG93bigpO1xuICAgICAgICB0aGlzLnB1YmxpY0tleSA9IG51bGw7XG4gICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbShMT0NBTF9TVE9SQUdFX0tFWV9GT1JfUFVCTElDX0tFWSk7XG4gICAgfVxuICAgIGFzeW5jIHNpZ25UcmFuc2FjdGlvbih0cmFuc2FjdGlvbikge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdGhpcy5jaGVja1dhbGxldFJlYWRpbmVzcygpO1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5zaWduVHJhbnNhY3Rpb25zKFt0cmFuc2FjdGlvbl0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdFswXTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGxldCBlcnJvclRvVGhyb3cgPSBlcnJvcjtcbiAgICAgICAgICAgIGlmICghKGVycm9yIGluc3RhbmNlb2YgV2FsbGV0RXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JUb1Rocm93ID0gbmV3IFdhbGxldFNpZ25UcmFuc2FjdGlvbkVycm9yKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogVU5LTk9XTl9FUlJPUl9NRVNTQUdFLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvclRvVGhyb3c7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgc2lnbkFsbFRyYW5zYWN0aW9ucyh0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHRoaXMuY2hlY2tXYWxsZXRSZWFkaW5lc3MoKTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc2lnblRyYW5zYWN0aW9ucyh0cmFuc2FjdGlvbnMpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGxldCBlcnJvclRvVGhyb3cgPSBlcnJvcjtcbiAgICAgICAgICAgIGlmICghKGVycm9yIGluc3RhbmNlb2YgV2FsbGV0RXJyb3IpKSB7XG4gICAgICAgICAgICAgICAgZXJyb3JUb1Rocm93ID0gbmV3IFdhbGxldFNpZ25UcmFuc2FjdGlvbkVycm9yKGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogVU5LTk9XTl9FUlJPUl9NRVNTQUdFLCBlcnJvcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aHJvdyBlcnJvclRvVGhyb3c7XG4gICAgICAgIH1cbiAgICB9XG4gICAgYXN5bmMgc2lnblRyYW5zYWN0aW9ucyh0cmFuc2FjdGlvbnMpIHtcbiAgICAgICAgbGV0IHJlc29sdmU7XG4gICAgICAgIGxldCByZWplY3Q7XG4gICAgICAgIGNvbnN0IGhhbmRsZVRyYW5zYWN0aW9uU2lnbmF0dXJlTmVlZGVkUmVzcG9uc2UgPSAocGF5bG9hZCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFhc3NlcnRQYXlsb2FkSXNUcmFuc2FjdGlvblNpZ25hdHVyZU5lZWRlZFJlc3BvbnNlUGF5bG9hZChwYXlsb2FkKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IFdhbGxldFNpZ25UcmFuc2FjdGlvbkVycm9yKCdNYWxmb3JtZWQgcGF5bG9hZCB3aGVuIHNpZ25pbmcgdHJhbnNhY3Rpb25zLiAnICtcbiAgICAgICAgICAgICAgICAgICAgJ0V4cGVjdGVkIHsgc2lnbmVkQjU4VHJhbnNhY3Rpb25zOiBzdHJpbmdbXSB9ICcgK1xuICAgICAgICAgICAgICAgICAgICBgYnV0IHJlY2VpdmVkICR7SlNPTi5zdHJpbmdpZnkocGF5bG9hZCl9YCk7XG4gICAgICAgICAgICAgICAgcmVqZWN0KGVycm9yKTtcbiAgICAgICAgICAgICAgICB0aGlzLnBvcHVwTWFuYWdlci5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IHNpZ25lZFRyYW5zYWN0aW9ucyA9IHBheWxvYWQuc2lnbmVkQjU4VHJhbnNhY3Rpb25zLm1hcChzaWduZWRCNThUcmFuc2FjdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIFRyYW5zYWN0aW9uLmZyb20oYmFzZTU4LmRlY29kZShzaWduZWRCNThUcmFuc2FjdGlvbikpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXNvbHZlKHNpZ25lZFRyYW5zYWN0aW9ucyk7XG4gICAgICAgICAgICB0aGlzLnBvcHVwTWFuYWdlci5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBoYW5kbGVDbG9zZWRPckRlbmllZEJ5VXNlciA9ICgpID0+IHtcbiAgICAgICAgICAgIHJlamVjdChuZXcgV2FsbGV0U2lnblRyYW5zYWN0aW9uRXJyb3IoJ1RoZSB1c2VyIGRpZCBub3QgYXBwcm92ZSB0aGUgdHJhbnNhY3Rpb24nKSk7XG4gICAgICAgICAgICB0aGlzLnBvcHVwTWFuYWdlci5jbG9zZSgpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBoYW5kbGVBdXRoTG9hZGVkID0gKCkgPT4ge1xuICAgICAgICAgICAgdmFyIF9hO1xuICAgICAgICAgICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgICAgICAgICAgICB1bnNpZ25lZEI1OFRyYW5zYWN0aW9uczogdHJhbnNhY3Rpb25zLm1hcCh0ID0+IGJhc2U1OC5lbmNvZGUodC5zZXJpYWxpemVNZXNzYWdlKCkpKSxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICAoX2EgPSB0aGlzLnBvcHVwTWFuYWdlci5nZXRDb25uZWN0aW9uKCkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZW5kKHtcbiAgICAgICAgICAgICAgICBldmVudDogUG9wdXBFdmVudC5UUkFOU0FDVElPTl9TSUdOQVRVUkVfTkVFREVELFxuICAgICAgICAgICAgICAgIHBheWxvYWQsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3Qgbm9uY2UgPSBjcmVhdGVOb25jZSgpO1xuICAgICAgICB0aGlzLnBvcHVwTWFuYWdlci5vcGVuKHtcbiAgICAgICAgICAgIGhlaWdodFB4OiBNYXRoLm1heChNSU5fUE9QVVBfSEVJR0hUX1BYLCBNYXRoLmZsb29yKHdpbmRvdy5pbm5lckhlaWdodCAqIDAuOCkpLFxuICAgICAgICAgICAgbm9uY2UsXG4gICAgICAgICAgICB1cmw6IGAke1NJR05fUEFHRV9VUkx9LyR7bm9uY2V9YCxcbiAgICAgICAgICAgIHdpZHRoUHg6IE1hdGgubWluKE1BWF9QT1BVUF9XSURUSF9QWCwgTWF0aC5mbG9vcih3aW5kb3cuaW5uZXJXaWR0aCAqIDAuOCkpLFxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5wb3B1cE1hbmFnZXIub25Db25uZWN0aW9uVXBkYXRlZChjb25uZWN0aW9uID0+IHtcbiAgICAgICAgICAgIGlmICghY29ubmVjdGlvbikge1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbm5lY3Rpb24ub24oUG9wdXBFdmVudC5UUkFOU0FDVElPTl9TSUdOQVRVUkVfTkVFREVEX1JFU1BPTlNFLCBoYW5kbGVUcmFuc2FjdGlvblNpZ25hdHVyZU5lZWRlZFJlc3BvbnNlKTtcbiAgICAgICAgICAgIGNvbm5lY3Rpb24ub24oUG9wdXBFdmVudC5UUkFOU0FDVElPTl9ERU5JRUQsIGhhbmRsZUNsb3NlZE9yRGVuaWVkQnlVc2VyKTtcbiAgICAgICAgICAgIGNvbm5lY3Rpb24ub24oUG9wdXBFdmVudC5QT1BVUF9DTE9TRUQsIGhhbmRsZUNsb3NlZE9yRGVuaWVkQnlVc2VyKTtcbiAgICAgICAgICAgIGNvbm5lY3Rpb24ub24oUG9wdXBFdmVudC5BVVRIX0xPQURFRCwgaGFuZGxlQXV0aExvYWRlZCk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHByb21pc2VSZXNvbHZlciwgcHJvbWlzZVJlamVjdG9yKSA9PiB7XG4gICAgICAgICAgICByZXNvbHZlID0gcHJvbWlzZVJlc29sdmVyO1xuICAgICAgICAgICAgcmVqZWN0ID0gcHJvbWlzZVJlamVjdG9yO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgY2hlY2tXYWxsZXRSZWFkaW5lc3MoKSB7XG4gICAgICAgIGlmICh0aGlzLnB1YmxpY0tleSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFdhbGxldE5vdENvbm5lY3RlZEVycm9yKCdgcHVibGljS2V5YCBpcyBudWxsLiBEaWQgeW91IGZvcmdldCB0byBjYWxsIGAuY29ubmVjdCgpYD8nKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWZyYWN0YWwtd2FsbGV0LWFkYXB0ZXItaW1wbC5qcy5tYXAiLCJleHBvcnQgZnVuY3Rpb24gY3JlYXRlTm9uY2UoKSB7XG4gICAgcmV0dXJuIGAke3JhbmRvbVN0cmluZygpfSR7cmFuZG9tU3RyaW5nKCl9JHtyYW5kb21TdHJpbmcoKX1gO1xufVxuZnVuY3Rpb24gcmFuZG9tU3RyaW5nKCkge1xuICAgIHJldHVybiAoTWF0aC5yYW5kb20oKSArIDEpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNyk7XG59XG4vLyMgc291cmNlTWFwcGluZ1VSTD1ub25jZS5qcy5tYXAiLCJleHBvcnQgKiBmcm9tIFwiLi9jb3JlL2ZyYWN0YWwtd2FsbGV0LWFkYXB0ZXItaW1wbC5qc1wiO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9aW5kZXguanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9